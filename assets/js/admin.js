(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{251:function(t,e,s){"use strict";s.r(e);var a=s(16);var o=function(t){var e=jQuery;let s=e("#toplevel_page_"+t),a=window.location.href,o=a.substr(a.indexOf("admin.php"));s.on("click","a",(function(){var t=e(this);e("ul.wp-submenu li",s).removeClass("current"),t.hasClass("wp-has-submenu")?e("li.wp-first-item",s).addClass("current"):t.parents("li").addClass("current")})),e("ul.wp-submenu a",s).each((function(t,s){e(s).attr("href")!==o||e(s).parent().addClass("current")}))},r=(s(18),{name:"BIQAdminApp",version:"1.0.1",props:{biq_app_url:{type:String,required:!0,default:"//"},biq_app_debug_enabled:{type:Boolean,default:!1}},data:()=>({initialised:!1,settings:{biq_api_host:"https://api.taxicode.com/",biq_pk:"",paypal_pk:"",stripe_pk:"",stripe_cardform_style:{base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}},quote_type:"",complete_page_text:"",custom_css:"",booking_test_mode:!1}}),created(){this.getAppSettings()},computed:{appSettings:function(){return{...this.settings}}},methods:{getAppSettings:function(){const t=this,e=this.biq_app_url+"settings-get/";this.biq_app_debug_enabled&&console.info(`Loading BIQ App Settings from '${e}'`),axios.get(e).then(e=>{t.appSettingsUpdated(e.data),t.initialised=!0}).catch(t=>{this.biq_app_debug_enabled&&(console.info("Updated Settings"),console.log(t),console.groupEnd()),console.error(t)})},appSettingsUpdated:function(t){if(this.biq_app_debug_enabled){console.group("Updating BIQ App Settings"),console.info({...this.settings}),console.info(t);try{console.log(t.stripe_cardform_style),console.log(typeof t.stripe_cardform_style),console.log(JSON.parse(t.stripe_cardform_style))}catch(t){console.error(t)}}const e={biq_pk:t.taxicode_public,biq_api_host:t.biq_api_host,paypal_pk:t.paypal_public,stripe_pk:t.stripe_public,stripe_cardform_style:t.stripe_cardform_style,quote_type:t.quote_type,complete_page_text:t.complete_page_text,custom_css:t.custom_css,booking_test_mode:t.test_mode};this.settings=e,this.biq_app_debug_enabled&&(console.info("Updated Settings"),console.info(e),console.info({...this.settings}),console.groupEnd())}}}),i=s(12),n=Object(i.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"biq-admin-vue-app"}},[s("h1",[t._v("Taxicode Booking Instant Quotes Admin")]),t._v(" "),t.initialised?s("router-view",{attrs:{debugging:t.biq_app_debug_enabled,appSettings:t.appSettings,appRESTBaseURL:t.biq_app_url},on:{appSettingsUpdated:t.appSettingsUpdated}}):t._e()],1)}),[],!1,null,null,null).exports,p=s(35);class l{constructor(){this.errors={}}has(t){return this.errors.hasOwnProperty(t)}any(){return Object.keys(this.errors).length>0}get(t){if(this.errors[t])return this.errors[t][0]}record(t){this.errors=t}clear(t){t?delete this.errors[t]:this.errors={}}}class _{constructor(t){this.originalData=t;for(let e in t)this[e]=t[e];this.errors=new l}data(){let t={};for(let e in this.originalData)t[e]=this[e];return t}reset(){for(let t in this.originalData)this[t]="";this.errors.clear()}post(t){return this.submit("post",t)}put(t){return this.submit("put",t)}patch(t){return this.submit("patch",t)}delete(t){return this.submit("delete",t)}submit(t,e){return new Promise((s,a)=>{axios[t](e,this.data()).then(t=>{this.onSuccess(t.data),s(t.data)}).catch(t=>{this.onFail(t.response.data),a(t.response.data)})})}onSuccess(t){return null!=typeof this.originalData.preserve_on_submit&&1==this.originalData.preserve_on_submit||this.reset(),t}onFail(t){this.errors.record(t)}}var c={name:"Settings",props:{appSettings:{type:Object,required:!0,default:null},appRESTBaseURL:{type:String,default:"//"},debugging:{type:Boolean,default:!1},biq_sk:{type:String,default:""}},data:()=>({message:"",message_extra:"",message_class:"",form:new _({taxicode_public:"",taxicode_private:"",biq_api_host:"https://api.taxicode.com/",stripe_public:"",stripe_cardform_style:"",paypal_public:"",complete_page_text:"",quote_type:"",custom_css:"",test_mode:0,preserve_on_submit:!0})}),created(){this.propogateSettingsToFormData(),this.form.taxicode_private=this.biq_sk},methods:{onReloadSettings:function(){this.propogateSettingsToFormData()},propogateSettingsToFormData:function(){this.form.taxicode_public=this.appSettings.biq_pk,this.form.biq_api_host=this.appSettings.biq_api_host,this.form.paypal_public=this.appSettings.paypal_pk,this.form.stripe_public=this.appSettings.stripe_pk,this.form.stripe_cardform_style=this.appSettings.stripe_cardform_style,this.form.quote_type=this.appSettings.quote_type,this.form.complete_page_text=this.appSettings.complete_page_text,this.form.custom_css=this.appSettings.custom_css,this.form.test_mode=this.appSettings.booking_test_mode},onSaveSettings:function(){const t=this,e=this.appRESTBaseURL+"settings-save/";this.debugging&&(console.info(`Updating BIQ App Settings to '${e}'`),console.info({...this.form.data()}),console.groupEnd()),this.form.post(e).then(e=>{t.message_class="updated",t.message="Settings Updated",t.$emit("appSettingsUpdated",{...e})}).catch(e=>{t.message_class="error",t.message="Failed to update settings!",e.hasOwnProperty("message")&&e.message&&(t.message_extra=e.message),console.error(t.message_extra),console.info({...e})}).finally(()=>{setTimeout(()=>{t.message="",t.message_extra="",t.message_class=""},5e3)})}}},m=Object(i.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-settings"},[s("h3",[t._v("Settings")]),t._v(" "),t.message?s("div",{class:t.message_class},[s("h4",[t._v(t._s(t.message))]),t._v(" "),t.message_extra?s("p",[t._v(t._s(t.message_extra))]):t._e()]):t._e(),t._v(" "),s("h3",[t._v("Taxicode Affiliate Settings")]),t._v(" "),s("table",{staticClass:"form-table",attrs:{role:"presentation"}},[s("tbody",[s("tr",[t._m(0),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.taxicode_public,expression:"form.taxicode_public"}],staticClass:"regular-text",attrs:{id:"taxicode_public",name:"taxicode_public",type:"text"},domProps:{value:t.form.taxicode_public},on:{input:function(e){e.target.composing||t.$set(t.form,"taxicode_public",e.target.value)}}})])]),t._v(" "),s("tr",[t._m(1),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.taxicode_private,expression:"form.taxicode_private"}],staticClass:"regular-text",attrs:{id:"taxicode_private",name:"taxicode_private",type:"text"},domProps:{value:t.form.taxicode_private},on:{input:function(e){e.target.composing||t.$set(t.form,"taxicode_private",e.target.value)}}})])]),t._v(" "),s("tr",[t._m(2),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.biq_api_host,expression:"form.biq_api_host"}],staticClass:"regular-text",attrs:{id:"biq_api_host",name:"biq_api_host",type:"text"},domProps:{value:t.form.biq_api_host},on:{input:function(e){e.target.composing||t.$set(t.form,"biq_api_host",e.target.value)}}})])])])]),t._v(" "),s("h3",[t._v("Payment Settings")]),t._v(" "),s("table",{staticClass:"form-table",attrs:{role:"presentation"}},[s("tbody",[s("tr",[t._m(3),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.paypal_public,expression:"form.paypal_public"}],staticClass:"regular-text",attrs:{id:"paypal_public",name:"paypal_public",type:"text"},domProps:{value:t.form.paypal_public},on:{input:function(e){e.target.composing||t.$set(t.form,"paypal_public",e.target.value)}}})])]),t._v(" "),s("tr",[t._m(4),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.stripe_public,expression:"form.stripe_public"}],staticClass:"regular-text",attrs:{id:"stripe_public",name:"stripe_public",type:"text"},domProps:{value:t.form.stripe_public},on:{input:function(e){e.target.composing||t.$set(t.form,"stripe_public",e.target.value)}}})])]),t._v(" "),s("tr",[t._m(5),t._v(" "),s("td",[t._m(6),t._v(" "),s("br"),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.stripe_cardform_style,expression:"form.stripe_cardform_style"}],staticClass:"regular-text code",attrs:{id:"stripe_cardform_style",name:"stripe_cardform_style",rows:"10",cols:"50"},domProps:{value:t.form.stripe_cardform_style},on:{input:function(e){e.target.composing||t.$set(t.form,"stripe_cardform_style",e.target.value)}}})])])])]),t._v(" "),s("h3",[t._v("Plugin Settings")]),t._v(" "),s("table",{staticClass:"form-table",attrs:{role:"presentation"}},[s("tbody",[s("tr",[t._m(7),t._v(" "),s("td",[t._m(8),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.test_mode,expression:"form.test_mode"}],attrs:{name:"test_mode",type:"radio",value:"1"},domProps:{checked:t._q(t.form.test_mode,"1")},on:{change:function(e){return t.$set(t.form,"test_mode","1")}}}),t._v("Making Bookings In Test Mode")]),s("br"),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.test_mode,expression:"form.test_mode"}],attrs:{name:"test_mode",type:"radio",value:"0"},domProps:{checked:t._q(t.form.test_mode,"0")},on:{change:function(e){return t.$set(t.form,"test_mode","0")}}}),t._v("Make Live Bookings")]),s("br")])]),t._v(" "),s("tr",[t._m(9),t._v(" "),s("td",[t._m(10),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.quote_type,expression:"form.quote_type"}],attrs:{name:"quote_type",type:"radio",value:"all"},domProps:{checked:t._q(t.form.quote_type,"all")},on:{change:function(e){return t.$set(t.form,"quote_type","all")}}}),t._v(" All")]),s("br"),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.quote_type,expression:"form.quote_type"}],attrs:{name:"quote_type",type:"radio",value:"best"},domProps:{checked:t._q(t.form.quote_type,"best")},on:{change:function(e){return t.$set(t.form,"quote_type","best")}}}),t._v(" Only Best")]),s("br"),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.quote_type,expression:"form.quote_type"}],attrs:{name:"quote_type",type:"radio",value:"type_class"},domProps:{checked:t._q(t.form.quote_type,"type_class")},on:{change:function(e){return t.$set(t.form,"quote_type","type_class")}}}),t._v(" Cheapest by type and class")]),s("br")])]),t._v(" "),s("tr",[t._m(11),t._v(" "),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.complete_page_text,expression:"form.complete_page_text"}],staticClass:"regular-text",attrs:{id:"complete_page_text",name:"complete_page_text",rows:"10",cols:"50"},domProps:{value:t.form.complete_page_text},on:{input:function(e){e.target.composing||t.$set(t.form,"complete_page_text",e.target.value)}}})])])])]),t._v(" "),s("h3",[t._v("Custom CSS")]),t._v(" "),s("table",{staticClass:"form-table",attrs:{role:"presentation"}},[s("tbody",[s("tr",[t._m(12),t._v(" "),s("td",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.custom_css,expression:"form.custom_css"}],staticClass:"regular-text code",attrs:{id:"custom_css",name:"custom_css",rows:"10",cols:"50"},domProps:{value:t.form.custom_css},on:{input:function(e){e.target.composing||t.$set(t.form,"custom_css",e.target.value)}}})])])])]),t._v(" "),t.message?s("div",{class:t.message_class},[s("h4",[t._v(t._s(t.message))]),t._v(" "),t.message_extra?s("p",[t._v(t._s(t.message_extra))]):t._e()]):t._e(),t._v(" "),s("button",{staticClass:"button button-primary",on:{click:t.onSaveSettings}},[t._v("Save Settings")]),t._v("\n    Â \n    "),s("button",{staticClass:"button",on:{click:t.onReloadSettings}},[t._v("Reload Settings")])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"taxicode_public"}},[this._v("Taxicode Public API Key")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"taxicode_private"}},[this._v("Taxicode Private API Key")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"biq_api_host"}},[this._v("Taxicode BIQ API Host")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"paypal_public"}},[this._v("Paypal Client ID")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"stripe_public"}},[this._v("Stripe Public API Key")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"stripe_cardform_style"}},[this._v("Stripe Cardform Custom Style")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n                        See "),e("a",{attrs:{href:"https://stripe.com/docs/js/appendix/style",title:"Stripe JS Card Element Style Object",target:"_blank"}},[this._v("Stripe JS Card Element Style Object")]),this._v(" for details of valid options.\n                    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",[this._v("Booking Test Mode")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("legend",{staticClass:"screen-reader-text"},[e("span",[this._v("Quotes")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",[this._v("Quote Display")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("legend",{staticClass:"screen-reader-text"},[e("span",[this._v("Quotes")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"complete_page_text"}},[this._v("Complete Page Text")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{scope:"row"}},[e("label",{attrs:{for:"custom_css"}},[this._v("Custom CSS")])])}],!1,null,null,null).exports;a.default.use(p.a);var u=new p.a({routes:[{path:"/",name:"Settings",component:m,props:{biq_sk:biq_sk}}]});a.default.config.productionTip=!1,a.default.config.devtools=!1,o("taxicode-app"),window.axios=s(18),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",new a.default({render:t=>t(n,{props:{biq_app_url:biq_app_url,biq_app_debug_enabled:biq_app_debug_enabled}}),el:"#biq-admin-vue-app",router:u})}},[[251,0,1]]]);
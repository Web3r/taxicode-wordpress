(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{14:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return p}));const o="https://api.taxicode.com/",i="https://api.stagingtaxis.co.uk/",s="auth/",a=(t,e,n,o)=>{if(o&&console.log("BIQ API response for - "+t,n),"OK"!=n.data.status){const t=n.data[n.data.status.toLowerCase()];throw console.warn(t),new ErrorEvent(n.data.status,{error:new Error("BIQ API Error"),message:t})}return n.data},p=(t,e,n,o)=>({data:{URL:t,key:e,message:o||n.message,error:n}})},16:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"f",(function(){return p})),n.d(e,"e",(function(){return r})),n.d(e,"b",(function(){return c}));var o=n(14),i=n(20);const s={base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}},a=(t,e)=>{if(e){console.log("stripe_cardform_style",t.stripe_cardform_style),console.info("type",typeof t.stripe_cardform_style);try{console.log("parse attempt",JSON.parse(t.stripe_cardform_style))}catch(t){console.error(t)}}return{biq_pk:t.taxicode_public,biq_api_host:t.biq_api_host,paypal_pk:t.paypal_public,stripe_pk:t.stripe_public,stripe_cardform_style:t.stripe_cardform_style,booking_test_mode:"1"==t.test_mode,quote_type:t.quote_type,recommend_upgrade:"1"==t.recommend_upgrade,complete_page_text:t.complete_page_text}},p=t=>({headers:{"X-WP-Nonce":t}}),r=function(t,e){this.appDebugEnabled&&(console.group("Updating BIQ App Settings"),console.log("BIQ App Settings",{...this.settings}),console.log("New BIQ Settings",t));const n="function"==typeof e?e.call(this,t):a(t,this.appDebugEnabled);this.settings=n,this.appDebugEnabled&&(console.info("Updated Settings"),console.log("Settings",n),console.log("BIQ App Settings",{...this.settings}),console.groupEnd())},c={LIVE_API_HOST:o.b,TEST_API_HOST:o.c,AUTH_URI:o.a,PLACES_URI:i.b,QUOTE_URI:i.c,JOURNEY_URI:i.a,CLIENT_SECRET_URI:"booking/client_gateway_secret/",PAYMENT_URI:"booking/pay/",PGH_CONF:{hidePostalCode:!0}};e.d=c},20:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return u}));var o=n(14),i=n(22),s=n.n(i);const a="places/?term=",p="booking/quote/",r="booking/journey/?id=",c=(t,e,n,i,a)=>new Promise((p,r)=>{s.a.get(`${t}${n}&key=${e}`).then(n=>Object(o.d)(t,e,n,a)).then(t=>t.results).then(t=>{let e=[],n=[],o=[];void 0!==t.AIRPORT&&(e=t.AIRPORT.map(t=>i(t,"airport"))),void 0!==t.STATION&&(n=t.STATION.map(t=>i(t,"station"))),void 0!==t.LOCATION&&(o=t.LOCATION.map(t=>i(t,"location")));const s=t.GOOGLE.map(t=>i(t.string,t.poi?"poi":"general"));p(e.concat(n,o,s))}).catch(n=>{const i=n.message||"Unknown";r(Object(o.e)(t,e,n,"BIQ Places lookup API Error - "+i))})}),u=(t,e,n,i)=>{let a=`pickup=${n.pickup}&destination=${n.destination}&date=${n.date} ${n.time}&people=${n.people}`;return n.hasReturn&&(a=`${a}&return=${n.returning.date} ${n.returning.time}`),n.vias.length&&(a=`${a}&via=${n.vias[0]}`),new Promise((n,p)=>{s.a.get(`${t}?key=${e}&${a}`).then(n=>Object(o.d)(t,e,n,i)).then(t=>{const e={journey_id:t.journey_id,journey:t.journey,quotes:t.quotes,count:Object.keys(t.quotes).length};e.count||(e.warnings=t.warnings),n(e)}).catch(n=>{const i=n.message||"Unknown";p(Object(o.e)(t,e,n,"BIQ Quotes Search API Error - "+i))})})}},264:function(t,e,n){"use strict";n.r(e);var o=n(13);var i=function(t){var e=jQuery;let n=e("#toplevel_page_"+t),o=window.location.href,i=o.substr(o.indexOf("admin.php"));n.on("click","a",(function(){var t=e(this);e("ul.wp-submenu li",n).removeClass("current"),t.hasClass("wp-has-submenu")?e("li.wp-first-item",n).addClass("current"):t.parents("li").addClass("current")})),e("ul.wp-submenu a",n).each((function(t,n){e(n).attr("href")!==i||e(n).parent().addClass("current")}))},s=n(28),a=n(16);var p={name:"BIQAdminApp",version:"1.0.1",props:{adminNonce:{type:String,default:""}},computed:{appConfig:function(){return{biq:a.b,BOOKING_DETALS_URI:"booking-details/?booking_ref="}}},methods:{appSettingsUpdated:a.e,getAdminSettings:function(){this.getAppSettings(()=>Object(a.f)(this.adminNonce),t=>({...Object(a.c)(t,this.appDebugEnabled),biq_sk:t.taxicode_private,search_target_permalink:t.search_target_permalink,custom_css:t.custom_css}))}},mixins:[s.a],data(){return{...s.a.data.call(this),settings:{biq_api_host:a.b.LIVE_API_HOST,biq_pk:"",paypal_pk:"",stripe_pk:"",stripe_cardform_style:a.a,booking_test_mode:!1,quote_type:"",recommend_upgrade:!1,complete_page_text:"",biq_sk:"",search_target_permalink:"/booking-instant-quotes/",custom_css:""},app_title:"Booking Instant Quotes Admin v1.0.1",admin_nonce:this.adminNonce}},created(){this.getAdminSettings()}},r=n(21),c=Object(r.a)(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"biq-admin-vue-app"}},[n("h1",[t._v(t._s(t.app_title))]),t._v(" "),t.initialised?n("router-view",{attrs:{"admin-nonce":t.admin_nonce,"app-config":t.appConfig,"app-settings":t.appSettings,appRESTBaseURL:t.appURL,debugging:t.appDebugEnabled},on:{appSettingsUpdated:t.appSettingsUpdated}}):t._e()],1)}),[],!1,null,null,null).exports,u=n(45);o.default.use(u.a);var d=new u.a({routes:[{path:"/",name:"SettingsPage",component:()=>n.e(2).then(n.bind(null,276))}]});o.default.config.productionTip=!1,o.default.config.devtools=!1,i("taxicode-app"),window.axios=n(22),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",new o.default({render:t=>t(c,{props:{adminNonce:admin_nonce,appURL:biqAppURL,appDebugEnabled:biqAppDebugEnabled}}),el:"#biq-admin-vue-app",router:d})},28:function(t,e,n){"use strict";var o=n(22),i=n.n(o);const s={props:{appURL:{type:String,required:!0,default:"//"},appDebugEnabled:{type:Boolean,default:!1}},computed:{appSettings:function(){return{...this.settings}}},methods:{getAppSettings:function(t,e){const n=this,o=this.appURL+"settings/";this.appDebugEnabled&&console.group(`Loading App Settings from '${o}'`);const s="function"==typeof t?t.call(this):{};i.a.get(o,s).then(t=>{n.appSettingsUpdated(t.data,e),n.initialised=!0}).catch(t=>{n.appDebugEnabled&&(console.info("Updated Settings Error"),console.log(t)),console.error(t)}).finally(()=>{n.appDebugEnabled&&console.groupEnd()})},appSettingsUpdated:function(t,e){this.appDebugEnabled&&(console.group("Updating App Settings"),console.log("App Settings",{...this.settings}),console.log("New Settings",t));const n="function"==typeof e?e.call(this,t):{...t};this.settings=n,this.appDebugEnabled&&(console.info("Updated Settings"),console.log("Settings",n),console.log("App Settings",{...this.settings}),console.groupEnd())}},data:()=>({initialised:!1,settings:{}})};e.a=s}},[[264,1,0]]]);
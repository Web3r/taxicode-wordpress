(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{215:function(t,e,s){var a={"./af":55,"./af.js":55,"./ar":56,"./ar-dz":57,"./ar-dz.js":57,"./ar-kw":58,"./ar-kw.js":58,"./ar-ly":59,"./ar-ly.js":59,"./ar-ma":60,"./ar-ma.js":60,"./ar-sa":61,"./ar-sa.js":61,"./ar-tn":62,"./ar-tn.js":62,"./ar.js":56,"./az":63,"./az.js":63,"./be":64,"./be.js":64,"./bg":65,"./bg.js":65,"./bm":66,"./bm.js":66,"./bn":67,"./bn.js":67,"./bo":68,"./bo.js":68,"./br":69,"./br.js":69,"./bs":70,"./bs.js":70,"./ca":71,"./ca.js":71,"./cs":72,"./cs.js":72,"./cv":73,"./cv.js":73,"./cy":74,"./cy.js":74,"./da":75,"./da.js":75,"./de":76,"./de-at":77,"./de-at.js":77,"./de-ch":78,"./de-ch.js":78,"./de.js":76,"./dv":79,"./dv.js":79,"./el":80,"./el.js":80,"./en-au":81,"./en-au.js":81,"./en-ca":82,"./en-ca.js":82,"./en-gb":83,"./en-gb.js":83,"./en-ie":84,"./en-ie.js":84,"./en-il":85,"./en-il.js":85,"./en-in":86,"./en-in.js":86,"./en-nz":87,"./en-nz.js":87,"./en-sg":88,"./en-sg.js":88,"./eo":89,"./eo.js":89,"./es":90,"./es-do":91,"./es-do.js":91,"./es-us":92,"./es-us.js":92,"./es.js":90,"./et":93,"./et.js":93,"./eu":94,"./eu.js":94,"./fa":95,"./fa.js":95,"./fi":96,"./fi.js":96,"./fil":97,"./fil.js":97,"./fo":98,"./fo.js":98,"./fr":99,"./fr-ca":100,"./fr-ca.js":100,"./fr-ch":101,"./fr-ch.js":101,"./fr.js":99,"./fy":102,"./fy.js":102,"./ga":103,"./ga.js":103,"./gd":104,"./gd.js":104,"./gl":105,"./gl.js":105,"./gom-deva":106,"./gom-deva.js":106,"./gom-latn":107,"./gom-latn.js":107,"./gu":108,"./gu.js":108,"./he":109,"./he.js":109,"./hi":110,"./hi.js":110,"./hr":111,"./hr.js":111,"./hu":112,"./hu.js":112,"./hy-am":113,"./hy-am.js":113,"./id":114,"./id.js":114,"./is":115,"./is.js":115,"./it":116,"./it-ch":117,"./it-ch.js":117,"./it.js":116,"./ja":118,"./ja.js":118,"./jv":119,"./jv.js":119,"./ka":120,"./ka.js":120,"./kk":121,"./kk.js":121,"./km":122,"./km.js":122,"./kn":123,"./kn.js":123,"./ko":124,"./ko.js":124,"./ku":125,"./ku.js":125,"./ky":126,"./ky.js":126,"./lb":127,"./lb.js":127,"./lo":128,"./lo.js":128,"./lt":129,"./lt.js":129,"./lv":130,"./lv.js":130,"./me":131,"./me.js":131,"./mi":132,"./mi.js":132,"./mk":133,"./mk.js":133,"./ml":134,"./ml.js":134,"./mn":135,"./mn.js":135,"./mr":136,"./mr.js":136,"./ms":137,"./ms-my":138,"./ms-my.js":138,"./ms.js":137,"./mt":139,"./mt.js":139,"./my":140,"./my.js":140,"./nb":141,"./nb.js":141,"./ne":142,"./ne.js":142,"./nl":143,"./nl-be":144,"./nl-be.js":144,"./nl.js":143,"./nn":145,"./nn.js":145,"./oc-lnc":146,"./oc-lnc.js":146,"./pa-in":147,"./pa-in.js":147,"./pl":148,"./pl.js":148,"./pt":149,"./pt-br":150,"./pt-br.js":150,"./pt.js":149,"./ro":151,"./ro.js":151,"./ru":152,"./ru.js":152,"./sd":153,"./sd.js":153,"./se":154,"./se.js":154,"./si":155,"./si.js":155,"./sk":156,"./sk.js":156,"./sl":157,"./sl.js":157,"./sq":158,"./sq.js":158,"./sr":159,"./sr-cyrl":160,"./sr-cyrl.js":160,"./sr.js":159,"./ss":161,"./ss.js":161,"./sv":162,"./sv.js":162,"./sw":163,"./sw.js":163,"./ta":164,"./ta.js":164,"./te":165,"./te.js":165,"./tet":166,"./tet.js":166,"./tg":167,"./tg.js":167,"./th":168,"./th.js":168,"./tk":169,"./tk.js":169,"./tl-ph":170,"./tl-ph.js":170,"./tlh":171,"./tlh.js":171,"./tr":172,"./tr.js":172,"./tzl":173,"./tzl.js":173,"./tzm":174,"./tzm-latn":175,"./tzm-latn.js":175,"./tzm.js":174,"./ug-cn":176,"./ug-cn.js":176,"./uk":177,"./uk.js":177,"./ur":178,"./ur.js":178,"./uz":179,"./uz-latn":180,"./uz-latn.js":180,"./uz.js":179,"./vi":181,"./vi.js":181,"./x-pseudo":182,"./x-pseudo.js":182,"./yo":183,"./yo.js":183,"./zh-cn":184,"./zh-cn.js":184,"./zh-hk":185,"./zh-hk.js":185,"./zh-mo":186,"./zh-mo.js":186,"./zh-tw":187,"./zh-tw.js":187};function i(t){var e=o(t);return s(e)}function o(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id=215},216:function(t,e){t.exports={QUOTE_URL:"https://api.taxicode.com/booking/quote/",JOURNEY_URL:"https://api.taxicode.com/booking/journey/?id=",PAYMENT_URL:"https://api.taxicode.com/booking/pay/"}},220:function(t,e,s){"use strict";s.r(e);var a=s(17),i=s(31),o=s(41),n=s(40),r=s(35),l=s(23),c=s(29),d=s(189),p=s(190),u=(s(45),s(46),{name:"App"}),m=s(14),h=Object(m.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"vue-frontend-app"}},[e("router-view")],1)}),[],!1,null,null,null).exports,_=s(27),v=s(18),g=s.n(v),f=s(38),y=s(192),j=s.n(y),b=s(37),k=s(6),C=s.n(k),w=s(36),x={name:"search",components:{"vue-bootstrap-typeahead":r.a,MglMap:b.b,MglMarker:b.c,MglGeojsonLayer:b.a},props:{postData:[]},data:()=>({journey_options:["One Way","Return"],type_map:{cheapest:"Cheapest Price",exec:"Best Executive",luxury:"Best Luxury",chauffeur:"Best Chauffeur"},journey_type:"One Way",pickup:"",via:"",vialocations:[],pickuplocations:[],destinationlocations:[],destination:"",date:"",time:"",return_date:"",return_time:"",people:"1",quotes:[],journey_id:"",loading:!1,errors:{pickup:!1,destination:!1,date:null,time:null,people:!1},quote_settings:"",asset_url:"",noquotes:!1,quotesloaded:!1,mindate:new Date,accessToken:mapbox_api,mapStyle:"mapbox://styles/taxicode-testing/cke2xdy4u1chp19n2abb4516w",pickup_coords:[-.118092,51.509865],destination_coords:[-.118092,51.509865],distance:1,geoJsonSource:{type:"geojson",data:{id:"thisIsMySource",type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[0,0]]}}},geoJsonLayer:{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#0876BA","line-width":4,"line-opacity":1}}}),watch:{pickup:f.a.debounce((function(t){this.locationSearch(t,"pickup")}),500),destination:f.a.debounce((function(t){this.locationSearch(t,"destination")}),500),via:f.a.debounce((function(t){this.locationSearch(t,"via")}),500)},computed:{mapCentre:function(){return[(this.pickup_coords[0]+this.destination_coords[0])/2,(this.pickup_coords[1]+this.destination_coords[1])/2]}},created(){this.postData=postData,this.mapPostToForm(),this.quote_settings=quote_settings,this.mapbox=j.a,this.asset_url=tcplugin_asset_path},mounted(){this.$refs.pickupfield.inputValue=this.pickup,this.$refs.destinationfield.inputValue=this.destination,this.$refs.viafield.inputValue=this.via,this.postData.search_on_load&&this.submitForm()},filters:{readable_date:t=>C()(String(t)).format("ll")},methods:{mapPostToForm:function(){void 0!==this.postData.journey_type&&(this.journey_type=this.postData.journey_type),void 0!==this.postData.pickup&&(this.pickup=this.postData.pickup),void 0!==this.postData.destination&&(this.destination=this.postData.destination),void 0!==this.postData.via&&(this.via=this.postData.via),void 0!==this.postData.date&&(this.date=this.postData.date),void 0!==this.postData.time&&(this.time=this.postData.time),void 0!==this.postData.people&&(this.people=this.postData.people),void 0!==this.postData.return_date&&(this.return_date=this.postData.return_date),void 0!==this.postData.return_time&&(this.return_time=this.postData.return_time)},setPrice:function(t){this.$store.commit("setPrice",t)},queryApi:function(){this.loading=!0,this.noquotes=!1,this.quotesloaded=!1;let t=config.QUOTE_URL+"?key="+tc_public_key+"&pickup="+this.pickup+"&destination="+this.destination+"&date="+this.date+" "+this.time+"&people="+this.people;"Return"==this.journey_type&&(t=t+"&return="+this.return_date+" "+this.return_time),""!=this.via&&(t=t+"&via="+this.via),g.a.get(t).then(function(t){this.loading=!1,0!=t.data.quotes.length?("type_class"==this.quote_settings?this.quotes=this.reduceToTypeAndClass(t.data.quotes):this.quotes=t.data.quotes,this.journey_id=t.data.journey_id,this.pickup_coords=[t.data.journey.pickup.position[1],t.data.journey.pickup.position[0]],this.destination_coords=[t.data.journey.destination.position[1],t.data.journey.destination.position[0]],this.distance=t.data.journey.distance,this.quotesloaded=!0,this.onMapChange()):(this.quotes=[],this.noquotes=!0,this.quotesloaded=!1)}.bind(this))},async onMapChange(){if(void 0!==this.$refs.mpbx){const e=this.$refs.mpbx.actions;await e.fitBounds([this.pickup_coords,this.destination_coords],{animate:!1}),await e.zoomOut();var t="https://api.mapbox.com/directions/v5/mapbox/driving/"+(this.pickup_coords.join(",")+";"+this.destination_coords.join(","))+"?geometries=geojson&access_token="+this.accessToken;g.a.get(t).then(function(t){this.geoJsonSource.data.geometry.coordinates=t.data.routes[0].geometry.coordinates}.bind(this))}},async onMapLoaded(t){const e=t.component.actions;await e.fitBounds([this.pickup_coords,this.destination_coords],{animate:!1}),await e.zoomOut();var s="https://api.mapbox.com/directions/v5/mapbox/driving/"+(this.pickup_coords.join(",")+";"+this.destination_coords.join(","))+"?geometries=geojson&access_token="+this.accessToken;g.a.get(s).then(function(t){this.geoJsonSource.data.geometry.coordinates=t.data.routes[0].geometry.coordinates}.bind(this))},reduceToTypeAndClass:function(t){let e=this.formatQuotes(t),s={};return s.cheapest=e.sorted.recommended[0],s.exec=e.sorted.executive[0],s.luxury=e.sorted.vip[0],s.chauffeur=e.sorted.chauffeur[0],s},formatQuotes:function(t){let e={},s={};for(let a in t){let i=t[a];if(i.active){e[a]=i,i.quote_id=a;for(let t=0;t<i.vehicles.length;t++){let e={...i};e.vehicle=i.vehicles[t],e.vehicle.index=t,e.price=e.vehicle.price;let a=e.vehicle.type.class;delete e.vehicles,s.hasOwnProperty("recommended")||(s.recommended=[]),e.highlight&&(0===t?s.recommended.push(e):e.highlight=!1),s.hasOwnProperty("all")||(s.all=[]),s.all.push(e),s.hasOwnProperty(a)||(s[a]=[]),s[a].push(e)}}}for(let t in s)s[t]=this.sortQuotes(s[t],"SORT_BY_PRICE");return{raw:e,sorted:s}},sortQuotes:function(t,e){switch(e){case"SORT_BY_PRICE":return t.sort((function(t,e){return t.price>e.price?1:e.price>t.price?-1:0}));case"SORT_BY_RATING":return t.sort((function(t,e){return t.rating.score>e.rating.score?-1:e.rating.score>t.rating.score?1:0}));default:return t}},submitForm:function(){this.validQuote()&&this.queryApi()},validQuote(){var t=!0;return""==this.pickup?(this.errors.pickup="Pickup location must be set",t=!1):this.errors.pickup=!1,""==this.destination?(this.errors.destination="Pickup location must be set",t=!1):this.errors.destination=!1,""==this.date?(this.errors.date=!1,t=!1):this.errors.date=null,""==this.time?(this.errors.time=!1,t=!1):this.errors.time=null,""==this.people?(this.errors.people,t=!1):this.errors.people=!1,t},flipImage:function(t,e){let s=this.quotes[t].vehicles[e.target.value].price;this.$refs[t][2].$el.setAttribute("data-price",s),this.$refs[t][0].src=this.quotes[t].vehicles[e.target.value].image,this.$refs[t][1].innerHTML="&pound;"+s+".00",this.setPrice(s+".00")},setPriceBeforeTransition:function(t,e){this.setPrice(e.target.dataset.price+".00")},locationSearch(t,e="pickup"){let s=[],a=[],i=[];g.a.get("https://api.taxicode.com/places/?term="+t).then(o=>{void 0!==o.data.results.STATION&&(a=o.data.results.STATION.map((function(t){return{string:t,type:"station"}}))),void 0!==o.data.results.AIRPORT&&(s=o.data.results.AIRPORT.map((function(t){return{string:t,type:"airport"}}))),void 0!==o.data.results.LOCATION&&(i=o.data.results.LOCATION.map((function(e){let s=Object(w.a)(t);if(s.length>0){let t=Object(w.a)(e);if(t.length>0&&s[0].indexOf(" ")>=0){let s=Object(w.b)(t[0]);e=e.replace(t[0],s)}}return{string:e,type:"location"}})));const n=s.concat(a.concat(i.concat(o.data.results.GOOGLE)));"pickup"==e?this.pickuplocations=n:"via"==e?this.vialocations=n:this.destinationlocations=n})}}},P=Object(m.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-content-between"},[s("div",{staticClass:"col-lg-4 pr-3 pr-lg-0 d-none d-lg-block"},[t.pickup_coords.length>0?s("MglMap",{ref:"mpbx",attrs:{center:t.mapCentre,accessToken:t.accessToken,mapStyle:t.mapStyle},on:{load:t.onMapLoaded}},[s("MglMarker",{attrs:{coordinates:t.pickup_coords,color:"blue"}}),t._v(" "),s("MglMarker",{attrs:{coordinates:t.destination_coords,color:"blue"}}),t._v(" "),s("MglGeojsonLayer",{attrs:{sourceId:t.geoJsonSource.data.id,source:t.geoJsonSource,layerId:"myLayer",layer:t.geoJsonLayer}})],1):t._e()],1),t._v(" "),s("div",{staticClass:"col-lg-8 pl-3 pl-lg-0"},[s("div",{staticClass:"form_1"},[s("form",{staticClass:"trav-quote-form",attrs:{id:"taxicode-quote"}},[s("input",{attrs:{name:"tcplugin_include_post",type:"hidden",value:"1"}}),t._v(" "),s("div",{staticClass:"top_form"},[s("b-form-select",{staticClass:"journey",attrs:{title:"One way or Return",options:t.journey_options},model:{value:t.journey_type,callback:function(e){t.journey_type=e},expression:"journey_type"}}),t._v(" "),s("vue-bootstrap-typeahead",{ref:"pickupfield",staticClass:"pickup",attrs:{inputClass:t.errors.pickup?"is-invalid":"",data:t.pickuplocations,serializer:function(t){return t.string},placeholder:"Pickup postcode or place name","max-matches":30},on:{hit:function(e){t.selectedLocation=e}},scopedSlots:t._u([{key:"suggestion",fn:function(e){var a=e.data,i=e.htmlText;return[s("div",{staticClass:"d-flex align-items-center"},["station"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"train"}})],1):"airport"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"plane"}})],1):s("span",[s("font-awesome-icon",{attrs:{icon:"map-marker-alt"}})],1),t._v(" "),s("span",{staticClass:"ml-4",domProps:{innerHTML:t._s(i)}})])]}}]),model:{value:t.pickup,callback:function(e){t.pickup=e},expression:"pickup"}}),t._v(" "),s("vue-bootstrap-typeahead",{ref:"viafield",staticClass:"via-input",attrs:{inputClass:t.errors.via?"is-invalid":"",data:t.vialocations,serializer:function(t){return t.string},placeholder:"Via postcode or place name","max-matches":30},on:{hit:function(e){t.selectedLocation=e}},scopedSlots:t._u([{key:"suggestion",fn:function(e){var a=e.data,i=e.htmlText;return[s("div",{staticClass:"d-flex align-items-center"},["station"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"train"}})],1):"airport"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"plane"}})],1):s("span",[s("font-awesome-icon",{attrs:{icon:"map-marker-alt"}})],1),t._v(" "),s("span",{staticClass:"ml-4",domProps:{innerHTML:t._s(i)}})])]}}]),model:{value:t.via,callback:function(e){t.via=e},expression:"via"}}),t._v(" "),s("vue-bootstrap-typeahead",{ref:"destinationfield",staticClass:"destination",attrs:{inputClass:t.errors.destination?"is-invalid":"",data:t.destinationlocations,serializer:function(t){return t.string},placeholder:"Destination postcode or place name","max-matches":30},on:{hit:function(e){t.selectedLocation=e}},scopedSlots:t._u([{key:"suggestion",fn:function(e){var a=e.data,i=e.htmlText;return[s("div",{staticClass:"d-flex align-items-center"},["station"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"train"}})],1):"airport"==a.type?s("span",[s("font-awesome-icon",{attrs:{icon:"plane"}})],1):s("span",[s("font-awesome-icon",{attrs:{icon:"map-marker-alt"}})],1),t._v(" "),s("span",{staticClass:"ml-4",domProps:{innerHTML:t._s(i)}})])]}}]),model:{value:t.destination,callback:function(e){t.destination=e},expression:"destination"}})],1),t._v(" "),s("div",{staticClass:"top_form mt-0"},[s("b-form-datepicker",{staticClass:"date",attrs:{locale:"en",min:t.mindate,state:t.errors.date},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},[s("template",{slot:"button-content"},[s("img",{attrs:{src:"https://www.x0101.co.uk/clients/travaroo/wp-content/uploads/2020/07/form-date.png"}})])],2),t._v(" "),s("b-form-timepicker",{staticClass:"time",attrs:{locale:"en",state:t.errors.time},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}},[s("template",{slot:"button-content"},[s("img",{attrs:{src:"https://www.x0101.co.uk/clients/travaroo/wp-content/uploads/2020/07/form-time.png"}})])],2),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.people,expression:"people"}],staticClass:"form-control",class:t.errors.people?"is-invalid":"",attrs:{type:"number",placeholder:"People"},domProps:{value:t.people},on:{input:function(e){e.target.composing||(t.people=e.target.value)}}}),t._v(" "),s("input",{staticClass:"submit-btn",attrs:{title:"Get Quotes",type:"submit",value:"Get a Quote"},on:{click:t.submitForm}})],1)])]),t._v(" "),s("div",{staticClass:"process_data"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-xl-9"},[s("div",{staticClass:"line_data"}),t._v(" "),s("ul",{staticClass:"list-inline data_line mb-0"},[s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/icon1.png"}}),t._v(" "),s("span",[t._v(t._s(t.journey_type))])]),t._v(" "),s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/icon2.png"}}),t._v(" "),s("span",[t._v(t._s(t.pickup))])]),t._v(" "),s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/icon3.png"}}),t._v(" "),s("span",[t._v(t._s(t.destination))])]),t._v(" "),s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/icon4.png"}}),t._v(" "),s("span",[t._v(t._s(t._f("readable_date")(t.date))+" @ "+t._s(t.time))])]),t._v(" "),s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/icon5.png"}}),t._v(" "),s("span",[t._v(t._s(t.people))])])])]),t._v(" "),t._m(0)])]),t._v(" "),s("div",{staticClass:"car_sec",attrs:{id:"results"}},[t.loading?s("div",[t._v("\n                Loading...\n            ")]):t._e(),t._v(" "),t.noquotes?s("div",[t._v("\n                Sorry, we could not find any quotes for the selected journey.  Please try a different journey.\n            ")]):t._e(),t._v(" "),t.quotesloaded?s("div",{staticClass:"row"},t._l(t.quotes,(function(e,a){return s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"car_box"},[s("h2",{staticClass:"mb-0"},[t._v(t._s(t.type_map[a]))]),t._v(" "),s("div",{staticClass:"car_detail px-4"},[s("div",{staticClass:"car_img py-4 text-center"},[s("img",{ref:e.quote_id,refInFor:!0,attrs:{src:e.vehicle.image,alt:"Vehicle type image"}})]),t._v(" "),s("p",{staticClass:"mb-1"},[t._v(t._s(e.company_name))]),t._v(" "),s("p",[s("img",{attrs:{src:t.asset_url+"/images/star_icon.png"}}),t._v(" ("+t._s(e.rating.ratings)+")")]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-7"},[s("div",{staticClass:"price_box text-center"},[s("div",{staticClass:"position-relative main_price"},[s("span",[t._v("£")]),t._v(t._s(e.price)+"\n                                        ")]),t._v(" "),s("p",[t._v("£"+t._s((e.price/t.distance).toFixed(2))+" per mile")])])]),t._v(" "),s("div",{staticClass:"col-5"},[s("div",{staticClass:"price_box text-center"},[s("ul",{staticClass:"list-inline mb-0 small_box"},[s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/price_icon1.png"}})]),t._v(" "),s("li",{staticClass:"list-inline-item"},[t._v(t._s(e.vehicle.passengers))])])]),t._v(" "),s("div",{staticClass:"price_box mt-2 text-center"},[s("ul",{staticClass:"list-inline mb-0 small_box"},[s("li",{staticClass:"list-inline-item"},[s("img",{attrs:{src:t.asset_url+"/images/price_icon2.png"}})]),t._v(" "),s("li",{staticClass:"list-inline-item"},[t._v(t._s(e.vehicle.luggage_small))])])])])]),t._v(" "),s("router-link",{ref:e.quote_id,refInFor:!0,staticClass:"booknow mt-3",attrs:{"data-price":e.price,to:{name:"Checkout",params:{quote_id:e.quote_id,journey_id:t.journey_id}}},nativeOn:{click:function(e){return t.setPriceBeforeTransition(t.id,e)}}},[t._v("Book Now")])],1)])])})),0):t._e()])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-12 pr-3 pr-lg-0 d-block d-lg-none"},[e("img",{attrs:{src:"image/map.jpg"}})])}],!1,null,null,null).exports,T={name:"Checkout",props:{card_created:{type:Boolean,default:!0}},computed:{price(){return this.$store.state.price}},data:()=>({name:"",email:"",telephone:"",flight_number:null,quote_id:null,journey_id:null,vehicle:0,journey_data:{},cardholder_name:"",errors:{name:!1,email:!1,telephone:!1},test_mode:0,loading:!1,payment_method:"Pay with card",payment_options:["Pay with card","Pay with Paypal"],posterror:!1}),created(){this.paypal_token=paypal_token,this.test_mode=test_mode,this.quote_id=this.$route.params.quote_id,this.journey_id=this.$route.params.journey_id,g.a.get(config.JOURNEY_URL+this.journey_id+"&include_quote=true").then(function(t){console.log(t.data),this.journey_data=t.data.journey}.bind(this))},mounted:function(){card=elements.create("card"),card.mount(this.$refs.card),this.card_created=!0},methods:{validate:function(){var t=!0;return""==this.name?(this.errors.name="Booking name must be set",t=!1):this.errors.name=!1,""!=this.email&&this.validEmail(this.email)?this.errors.email=!1:(this.errors.email="Valid email must be set",t=!1),""==this.telephone?(this.errors.telephone="Telephone must be set",t=!1):this.errors.telephone=!1,"Pay with card"==this.payment_method&&(""==this.cardholder_name?(this.errors.cardholder_name="Cardholder name must be set",t=!1):this.errors.cardholder_name=!1),t},validEmail:function(t){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},onPaypalSubmit:function(t){this.validate()&&(this.posterror=!1,this.loading=1,this.makeBooking(t.nonce,"paypal"))},onPaypalError:function(t){},onLoadFail:function(t){console.log(t)},makeBooking:function(t,e){let s=new FormData;s.append("email",this.email),s.append("name",this.name),s.append("telephone",this.telephone),s.append("key",tc_public_key),s.append("quote",this.quote_id),s.append("vehicle",this.vehicle),s.append("test",this.test_mode),s.append("new_pay",!0),s.append("payment_token",t),"stripe"==e?s.append("method","googlepay"):s.append("method","paypal"),g.a.post(config.PAYMENT_URL,s,{headers:{"Content-Type":"application/application/x-www-form-urlencoded"}}).then(function(t){"OK"==t.data.status?this.$router.push({name:"Complete",params:{booking_ref:t.data.reference}}):(this.posterror=t.data.error,this.loading=0)}.bind(this)).catch(function(t){this.loading=0}.bind(this))},onSubmit:function(){this.validate()&&("Pay with card"==this.payment_method?this.onStripeSubmit():this.onPaypalSubmit())},onStripeSubmit:function(){this.posterror=!1,this.loading=1;var t=this;stripe.createToken(card).then(function(e){if(e.error)return this.loading=0,t.hasCardErrors=!0,void t.$forceUpdate();let s=e.token.id;this.makeBooking(s,"stripe")}.bind(this))},mountStripe:function(){"Pay with card"==this.payment_method?this.$nextTick((function(){this.card_created||(console.log("creting card"),card=elements.create("card"),this.card_created=!0),console.log("mounting card"),card.mount(this.$refs.card)})):card.unmount(this.$refs.card)}}},q=Object(m.a)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{attrs:{id:"purchaseform"}},[t._m(0),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-passenger-name"}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"customer_name"}},[t._v("Name")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",class:t.errors.name?"is-invalid":"",attrs:{type:"text",id:"customer_name","aria-describedby":"nameHelp",placeholder:"Enter your name",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"nameHelp"}},[t._v("The name of the person travelling,")])])]),t._v(" "),s("div",{staticClass:"col"},[s("div",{staticClass:"form-group",attrs:{id:"tcplugin-email"}},[s("label",{attrs:{for:"customer_email"}},[t._v("Email")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",class:t.errors.email?"is-invalid":"",attrs:{type:"email",id:"customer_email","aria-describedby":"emailHelp",placeholder:"Enter your email",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"emailHelp"}},[t._v("We'll never share your email with anyone else.")])])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-passenger-telephone"}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"telephone"}},[t._v("Mobile telephone")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.telephone,expression:"telephone"}],staticClass:"form-control",class:t.errors.telephone?"is-invalid":"",attrs:{type:"text",id:"telephone","aria-describedby":"mobileHelp",placeholder:"Enter a mobile number",required:""},domProps:{value:t.telephone},on:{input:function(e){e.target.composing||(t.telephone=e.target.value)}}}),t._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"mobileHelp"}},[t._v("Valid UK mobile numbers only, please")])])]),t._v(" "),s("div",{staticClass:"col"},[s("div",{staticClass:"form-group",attrs:{id:"tcplugin-flight-number"}},[s("label",{attrs:{for:"flight_number"}},[t._v("Flight #")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.flight_number,expression:"flight_number"}],staticClass:"form-control",attrs:{type:"text",id:"flight_number","aria-describedby":"flightHelp",placeholder:"Enter your flight number"},domProps:{value:t.flight_number},on:{input:function(e){e.target.composing||(t.flight_number=e.target.value)}}}),t._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"flightHelp"}},[t._v("If this is an airport pickup or dropoff, the relevent flight number")])])])]),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-payament-select"}},[t._v("\n                Select Payment Method:\n            ")]),t._v(" "),s("div",{staticClass:"col"},[s("b-form-select",{attrs:{options:t.payment_options},on:{change:t.mountStripe},model:{value:t.payment_method,callback:function(e){t.payment_method=e},expression:"payment_method"}})],1)]),t._v(" "),"Pay with card"==t.payment_method?s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-cardholder-name"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"card-holder-name"}},[t._v("Cardholder Name")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.cardholder_name,expression:"cardholder_name"}],staticClass:"form-control",class:t.errors.cardholder_name?"is-invalid":"",attrs:{id:"card-holder-name",type:"text",placeholder:"Cardholder name"},domProps:{value:t.cardholder_name},on:{input:function(e){e.target.composing||(t.cardholder_name=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"col",attrs:{id:"tcplugin-stripe-card-details"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"card"}},[t._v("Card Details")]),t._v(" "),s("div",{ref:"card",staticClass:"form-control",attrs:{id:"card"}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("input",{staticClass:"btn btn-primary",attrs:{type:"button",value:0==t.loading?"Book Now":"Processing",disabled:1==t.loading},on:{click:t.onSubmit}})])])]):s("div",{staticClass:"row"},[s("div",{staticClass:"col"}),t._v(" "),s("div",{staticClass:"col",attrs:{id:"tcplugin-paypal-plugin"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"paypal"}},[t._v("Or Pay With Paypal")]),t._v(" "),s("v-braintree",{attrs:{authorization:t.paypal_token,paypal:{flow:"checkout",amount:t.price,currency:"GBP"}},on:{success:t.onPaypalSubmit,error:t.onPaypalError,loadFail:t.onLoadFail},scopedSlots:t._u([{key:"button",fn:function(e){return[s("div",{staticClass:"form-group"},[s("input",{staticClass:"btn btn-primary",attrs:{type:"button",value:0==t.loading?"Book Now":"Processing",disabled:1==t.loading},on:{click:e.submit}})])]}}])})],1)])]),t._v(" "),t.posterror?s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-payment-error"}},[t._v("\n                "+t._s(t.posterror)+"\n            ")])]):t._e(),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-checkout-booking-details"}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[t._v("\n                        Booking Details\n                    ")]),t._v(" "),s("ul",{staticClass:"list-group list-group-flush"},[s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Date:")]),t._v(" "+t._s(t.journey_data.date)+" at "+t._s(t.journey_data.time)+"\n                        ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Travelling From:")]),t._v(" "+t._s(t.journey_data.pickup)+"\n                        ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Going To:")]),t._v(" "+t._s(t.journey_data.destination)+"\n                        ")]),t._v(" "),t.journey_data.via?s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Via:")]),t._v(" "+t._s(t.journey_data.vias[0].string)+"\n                        ")]):t._e(),t._v(" "),t.journey_data.return?s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Returning:")]),t._v(" "+t._s(t.journey_data.return)+" at "+t._s(t.journey_data.return_time)+"\n                        ")]):t._e(),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Price:")]),t._v(" £"+t._s(t.price)+"\n                        ")])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("h4",{attrs:{id:"tc_plugin-passenger-heading"}},[this._v("Passenger Details")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("h4",{attrs:{id:"tc_plugin-payment-heading"}},[this._v("Payment Details")])])])}],!1,null,"012c034f",null).exports,O={name:"Complete.vue",data:()=>({booking_ref:"",booking_name:"",booking_date:"",booking_from:"",booking_to:"",complete_page_text:""}),created(){this.complete_page_text=complete_page_text,this.complete_page_url=complete_page_url,this.booking_ref=this.$route.params.booking_ref,g.a.get(this.complete_page_url+this.booking_ref).then(function(t){this.booking_name=t.data.booking.passenger.name,this.booking_date=t.data.booking.date_elements.day+" "+t.data.booking.date_elements.month+" "+t.data.booking.date_elements.year+" at "+t.data.booking.date_elements.hours+":"+t.data.booking.date_elements.minutes,this.booking_from=t.data.booking.pickup.string,this.booking_to=t.data.booking.destination.string}.bind(this))}},S=Object(m.a)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"completePage"}},[s("h3",[t._v("Your booking is complete")]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("p",[t._v(t._s(t.complete_page_text))])]),t._v(" "),s("div",{staticClass:"col"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[t._v("\n                    Booking Details\n                ")]),t._v(" "),s("ul",{staticClass:"list-group list-group-flush"},[s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Booking Reference:")]),t._v(" "+t._s(t.booking_ref)+"\n                    ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Name:")]),t._v(" "+t._s(t.booking_name)+"\n                    ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Date:")]),t._v(" "+t._s(t.booking_date)+"\n                    ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Travelling From:")]),t._v(" "+t._s(t.booking_from)+"\n                    ")]),t._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[t._v("Going To:")]),t._v(" "+t._s(t.booking_to)+"\n                    ")])])])])])])}),[],!1,null,"b40e9eaa",null).exports;a.default.use(_.a);var D=new _.a({routes:[{path:"/",name:"Home",component:P},{path:"/checkout/:quote_id/:journey_id",name:"Checkout",component:q},{path:"/complete/:booking_ref",name:"Complete",component:S}]}),z=s(194),E=s(42);a.default.use(i.a);var L=new i.a.Store({state:{price:0},mutations:{setPrice(t,e){t.price=e}},plugins:[Object(z.a)({getState:t=>E.getJSON(t),setState:(t,e)=>E.set(t,e,{expires:3,secure:!0})})]});l.c.add(c.b,c.d,c.a,c.e,c.c),a.default.component("font-awesome-icon",d.a);const $=s(216);window.config=$,a.default.use(o.a),a.default.use(n.a),a.default.use(i.a),a.default.use(r.a),a.default.use(p.a),a.default.config.productionTip=!1,new a.default({el:"#vue-frontend-app",router:D,store:L,render:t=>t(h)})}},[[220,0,1]]]);
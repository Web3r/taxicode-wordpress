(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{15:function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"f",(function(){return p})),o.d(t,"e",(function(){return l})),o.d(t,"d",(function(){return h})),o.d(t,"c",(function(){return b})),o.d(t,"b",(function(){return m}));const r=(e,t)=>e.price>t.price?1:t.price>e.price?-1:0,s=(e,t)=>e.rating.score>t.rating.score?-1:t.rating.score>e.rating.score?1:0,n=(e,t)=>{switch(t){case"SORT_BY_PRICE":return e.sort(r);case"SORT_BY_RATING":return e.sort(s);default:return e}};const i=(e,t,o)=>{const r=[];console.group("Formatting BIQ Quotes"),console.log("Quotes",{...e}),console.log("Type",t),console.log("Sort Order",o),Object.keys(e).forEach(o=>{const s={...e[o],quote_id:o,selected_vehicle:0};("best"!=t||"best"==t&&s.highlight)&&r.push(s)});const s=n(r,o);return console.log("Sorted",s),console.groupEnd(),s},a=(e,t)=>{console.group("Reducing BIQ Quotes to type & class only"),console.log("Quotes",{...e}),console.log("Sort Order",t);const o=u(e,t);console.log({...o});const r=o.sorted,s={};return r.hasOwnProperty("recommended")&&r.recommended.length&&(s.cheapest=r.recommended[0]),r.hasOwnProperty("executive")&&r.executive.length&&(s.exec=r.executive[0]),r.hasOwnProperty("vip")&&r.vip.length&&(s.luxury=r.vip[0]),r.hasOwnProperty("chauffeur")&&r.chauffeur.length&&(s.chauffeur=r.chauffeur[0]),console.log("Sorted",s),console.groupEnd(),s},u=(e,t)=>{let o={},r={};for(let t in e){let s=e[t];if(s.active){o[t]=s,s.quote_id=t;for(let e=0;e<s.vehicles.length;e++){let t={...s};t.selected_vehicle=e,t.vehicle=s.vehicles[e],t.vehicle.index=t.selected_vehicle,t.price=t.vehicle.price;let o=t.vehicle.type.class;delete t.vehicles,r.hasOwnProperty("recommended")||(r.recommended=[]),t.highlight&&(0===e?r.recommended.push(t):t.highlight=!1),r.hasOwnProperty("all")||(r.all=[]),r.all.push(t),r.hasOwnProperty(o)||(r[o]=[]),r[o].push(t)}}}for(let e in r)r[e]=n(r[e],t);return{raw:o,sorted:r}};const c="SORT_BY_PRICE",p={biqQuotesSearched:{name:"biqQuotesSearched"},biqZeroQuotes:{name:"biqZeroQuotes"},biqQuotesError:{name:"biqQuotesError"}},l={biqQuoteBookNow:{name:"biqQuoteBookNow"}},d={string:"",postcode:"",position:[0,0]},g={pickup:d,destination:d,vias:[],people:1,return:!1,date:"",distance:1,duration:116,duration_text:"1 min",quote_type:"mileage",is_airport:!1,hourly:!1},h=e=>({pickup:e.pickup,destination:e.destination,vias:e.vias,people:e.people,return:e.return,date:e.date,distance:e.distance,duration:e.duration,duration_text:e.duration_text,quote_type:e.quote_type,is_airport:e.is_airport,hourly:e.hourly}),b=(e,t,o)=>({type:t,quotes:"type_class"==t?a(e,"SORT_BY_PRICE"):i(e,t,o)}),m=()=>({quoting:!1,quotes_loaded:!1,api_error:!1,journey_id:"",journey_details:h(g),journey_quotes:{}})},17:function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"c",(function(){return s})),o.d(t,"b",(function(){return n}));const r={base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}},s=(e,t)=>{if(t){console.log("stripe_cardform_style",e.stripe_cardform_style),console.info("type",typeof e.stripe_cardform_style);try{console.log("parse attempt",JSON.parse(e.stripe_cardform_style))}catch(e){console.error(e)}}return{biq_pk:e.taxicode_public,biq_api_host:e.biq_api_host,paypal_pk:e.paypal_public,stripe_pk:e.stripe_public,stripe_cardform_style:e.stripe_cardform_style,booking_test_mode:"1"==e.test_mode,quote_type:e.quote_type,recommend_upgrade:"1"==e.recommend_upgrade,complete_page_text:e.complete_page_text}},n={LIVE_API_HOST:"https://api.taxicode.com/",TEST_API_HOST:"https://api.stagingtaxis.co.uk/",PLACES_URI:"places/?term=",AUTH_URI:"auth/",QUOTE_URI:"booking/quote/",JOURNEY_URI:"booking/journey/?id=",CLIENT_SECRET_URI:"booking/client_gateway_secret/",PAYMENT_URI:"booking/pay/",PGH_CONF:{hidePostalCode:!0},useButtons:!0};t.d=n},18:function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return s})),o.d(t,"e",(function(){return i})),o.d(t,"i",(function(){return a})),o.d(t,"c",(function(){return u})),o.d(t,"f",(function(){return c})),o.d(t,"g",(function(){return p})),o.d(t,"h",(function(){return l})),o.d(t,"d",(function(){return d}));const r="Pay with Card",s="Pay with Paypal",n=[r,s],i={method:{selected:r,options:n,label:"Select Payment Method:",errorMsg:"Cardholder name must be set",id:"tcplugin-payament-select"}},a={submit:{name:"submit"},transactionSuccess:{name:"transactionSuccess"},transactionError:{name:"transactionError"}},u={biqCheckoutSubmit:{name:"biqCheckoutSubmit"},biqCheckoutComplete:{name:"biqCheckoutComplete"},biqCheckoutError:{name:"biqCheckoutError"}},c=e=>new Date(Date.parse(e)),p=e=>c(e).toDateString(),l=e=>c(e).toLocaleTimeString(),d=()=>({processing:!1,processed:!1,basket:{quote_id:"",vehicle_index:0,amount:0},quote:{},vehicle:{},booking_ref:""})},253:function(e,t,o){"use strict";o.r(t);var r=o(13),s=o(62),n=o(64),i=(o(83),o(84),o(25)),a=o(23),u=o(60),c=o(21),p=o(30),l=o(17),d=o(80);var g={name:"BIQAppSearchLite",version:"1.0.1",props:{...{biqAppConfig:{type:Object,required:!0,default:function(){return{biq:l.b}}}}},computed:{...{...Object(c.c)(["searchDetails","hasSearchResults","displayType","displayQuotes","loadingQuotes","quotesError","quotesLoaded","zeroQuotes","journeyID","journeyDetails","journeyDate","journeyTime","journeyHasReturn","journeyReturnDate","journeyReturnTime","journeyHasVias","journeyQuotes"]),appConfig:function(){return{...this.biqAppConfig}}}},methods:{...{...Object(c.b)(["resetSearch","searchingQuotes","searchedQuotes","changeDisplayType","resetQuotes","quoting","apiQuotesError","quoted"]),appSettingsUpdated:function(e){this.appDebugEnabled&&(console.group("Updating BIQ App Settings"),console.log("BIQ App Settings",{...this.settings}),console.log("New BIQ Settings",e));const t=Object(l.c)(e,this.appDebugEnabled);this.settings=t,this.appDebugEnabled&&(console.info("Updated Settings"),console.log("Settings",t),console.log("BIQ App Settings",{...this.settings}),console.groupEnd())},onSearchQuotes:function(e){}}},mixins:[p.a],components:{"the-biq-search-form":d.a},data(){return{search_on_load:!1,settings:{biq_api_host:this.biqAppConfig.biq.LIVE_API_HOST,biq_pk:"",paypal_pk:"",stripe_pk:"",stripe_cardform_style:l.a,booking_test_mode:!1,quote_type:"",recommend_upgrade:!1,complete_page_text:""}}},created(){this.getAppSettings()}},h=o(19),b=Object(h.a)(g,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"biq-search-lite-vue-app"}},[e.initialised?o("the-biq-search-form",{attrs:{"biq-public-key":e.appSettings.biq_pk,"biq-places-lookup":""+e.appSettings.biq_api_host+e.appConfig.biq.PLACES_URI,"biq-quotes-from":""+e.appSettings.biq_api_host+e.appConfig.biq.QUOTE_URI,"search-on-load":e.search_on_load,debugging:e.appDebugEnabled,"use-buttons":e.appConfig.biq.useButtons,layout:"compact"},on:{biqSearchQuotes:e.onSearchQuotes}}):e._e()],1)}),[],!1,null,null,null).exports,m=o(46),_=o(45);r.default.config.productionTip=!1,r.default.config.devtools=!1,r.default.use(s.a),r.default.use(n.a),i.c.add(a.b,a.d,a.a,a.e,a.c),r.default.component("font-awesome-icon",u.a),new r.default({store:m.a,render:e=>e(b,{props:{appURL:biqAppURL,appDebugEnabled:biqAppDebugEnabled,biqAppConfig:_.a}}),el:"#biq-vue-app"})},30:function(e,t,o){"use strict";var r=o(33),s=o.n(r);const n={props:{appURL:{type:String,required:!0,default:"//"},appDebugEnabled:{type:Boolean,default:!1}},computed:{appSettings:function(){return{...this.settings}}},methods:{getAppSettings:function(){const e=this,t=this.appURL+"settings-get/";this.appDebugEnabled&&console.group(`Loading App Settings from '${t}'`),s.a.get(t).then(t=>{e.appSettingsUpdated(t.data),e.initialised=!0}).catch(t=>{e.appDebugEnabled&&(console.info("Updated Settings"),console.log(t)),console.error(t)}).finally(()=>{e.appDebugEnabled&&console.groupEnd()})},appSettingsUpdated:function(e){this.appDebugEnabled&&(console.group("Updating App Settings"),console.log("App Settings",{...this.settings}),console.log("New Settings",e));const t={...e};this.settings=t,this.appDebugEnabled&&(console.info("Updated Settings"),console.log("Settings",t),console.log("App Settings",{...this.settings}),console.groupEnd())}},data:()=>({initialised:!1,settings:{}})};t.a=n},36:function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"c",(function(){return i})),o.d(t,"b",(function(){return p}));const r="Return",s=["One Way",r],n=s[0],i=e=>({journey_type:{selected:n,options:s,label:"Journey type",required:!1,error:null,errorMsg:"",id:e+"-journey",placeholder:""},pickup:{value:"",label:"Pickup",required:!0,error:null,errorMsg:"Pickup location must be set",id:e+"-pickup",placeholder:"Pickup postcode or place name"},destination:{value:"",label:"Destination",required:!0,error:null,errorMsg:"Destination location must be set",id:e+"-destination",placeholder:"Destination postcode or place name"},via:{value:"",label:"(Optional) Via",required:!1,error:null,errorMsg:"",id:e+"-via",placeholder:"Via postcode or place name"},people:{value:"1",label:"Number of People",required:!0,error:null,errorMsg:"Invalid number of people travelling",id:e+"-people",placeholder:""}}),a=(e,t,o)=>(e.setDate(e.getDate()+t),e.setHours(e.getHours()+o),e),u=()=>a(new Date,1,2),c=e=>e<10?"0"+e:e,p=()=>{const e=u();return{search_details:{journey_type:n,pickup:"",vias:[],destination:"",date:e.getFullYear()+"-"+c(e.getMonth()+1)+"-"+c(e.getDate()),time:c(e.getHours())+":"+c(e.getMinutes())+":"+c(e.getSeconds()),people:"1",returning:{date:"",time:""}},results:!1,display_type:"",display_quotes:[]}}},45:function(e,t,o){"use strict";const r={biq:{...o(17).d},BOOKING_DETALS_URI:"booking-details/?booking_ref="};t.a=r},46:function(e,t,o){"use strict";var r=o(13),s=o(21),n=o(61),i=o(36),a=o(15);var u={state:Object(i.b)(),getters:{searchDetails:e=>e.search_details,hasSearchResults:e=>e.results,displayType:e=>e.display_type,displayQuotes:e=>e.display_quotes},actions:{resetSearch({commit:e,dispatch:t}){t("resetQuotes",null,{root:!0}),e("resetSearchState")},searchingQuotes({commit:e,dispatch:t},o){e("resetSearchState"),t("quoting",null,{root:!0}),e("searchingQuotesFor",o)},searchedQuotes({commit:e,dispatch:t},o){t("quoted",o,{root:!0}),Object.keys(o.quotes).length>0&&e("displaying",Object(a.c)(o.quotes,o.display_type,a.a))},changeDisplayType({commit:e,rootGetters:t},o){e("displaying",Object(a.c)(t.journeyQuotes,o,a.a))}},mutations:{resetSearchState(e){Object.assign(e,Object(i.b)())},searchingQuotesFor(e,t){e.search_details=t},displaying(e,t){e.display_quotes=t.quotes,e.display_type=t.type,e.results=!0}}},c=o(18);var p={search:u,quotes:{state:Object(a.b)(),getters:{loadingQuotes:e=>e.quoting,quotesError:e=>e.api_error,quotesLoaded:e=>e.quotes_loaded,zeroQuotes:e=>!!e.quotes_loaded&&0===Object.keys(e.journey_quotes).length,journeyID:e=>e.journey_id,journeyDetails:e=>e.journey_details,journeyDate:e=>Object(c.g)(e.journey_details.date),journeyTime:e=>Object(c.h)(e.journey_details.date),journeyReturnDate:e=>e.journey_details.return&&Object(c.g)(e.journey_details.return),journeyReturnTime:e=>e.journey_details.return&&Object(c.h)(e.journey_details.return),journeyHasReturn:e=>!!e.journey_details.return,journeyHasVias:e=>Array.isArray(e.journey_details.vias)&&e.journey_details.vias.length>0,journeyQuotes:e=>e.journey_quotes},actions:{resetQuotes({commit:e}){e("resetQuotesState")},quoting({commit:e,dispatch:t}){e("resetQuotesState"),t("resetCheckout",null,{root:!0}),e("searching")},apiQuotesError({commit:e},t){e("quotesError",{api_error:t}),e("searched")},quoted({commit:e},t){e("searched"),e("quotes",t)}},mutations:{resetQuotesState(e){Object.assign(e,Object(a.b)())},searching(e){e.quoting=!0},quotesError(e,t){e.api_error=t.api_error},searched(e){e.quoting=!1},quotes(e,t){e.journey_id=t.journey_id,e.journey_quotes=t.quotes,e.journey_details=Object(a.d)(t.journey),e.quotes_loaded=!0}}},checkout:{state:Object(c.d)(),getters:{processed:e=>e.processed,processing:e=>e.processing,basket:e=>({quote:e.basket.quote_id,vehicle:e.basket.vehicle_index,price:e.basket.amount}),quoteID:e=>e.basket.quote_id,vehicleIndex:e=>e.basket.vehicle_index,price:e=>e.basket.amount,quoteData:e=>e.quote,quoteVehicleData:e=>e.vehicle,bookingRef:e=>e.booking_ref},actions:{resetCheckout({commit:e}){e("resetCheckoutState")},bookNow({commit:e},t){e("resetCheckoutState"),e("buildBasket",t)},booking({commit:e}){e("processing",{processing:!0,processed:!1})},bookingFailed({commit:e}){e("processing",{processing:!1,processed:!1})},booked({commit:e},t){e("resetCheckoutState");e("processing",{processing:!1,processed:!1}),e("booked",{booking_ref:t})}},mutations:{resetCheckoutState(e){Object.assign(e,Object(c.d)())},buildBasket(e,t){e.basket.quote_id=t.quote,e.basket.vehicle_index=t.vehicle,e.basket.amount=t.quote_data.vehicles[t.vehicle].price,e.quote=t.quote_data,e.vehicle=t.quote_data.vehicles[t.vehicle]},processing(e,t){e.processing=t.processing,e.processed=t.processed},booked(e,t){e.booking_ref=t.booking_ref}}}};r.default.use(s.a);t.a=new s.a.Store({modules:{BIQSearchStateStore:p.search,BIQQuotesStateStore:p.quotes,BIQCheckoutStateStore:p.checkout},plugins:[Object(n.a)({paths:["BIQSearchStateStore","BIQQuotesStateStore","BIQCheckoutStateStore"],storage:window.localStorage})]})},80:function(e,t,o){"use strict";var r=o(15);const s={column:{name:"column",tag:"the-biq-search-form-column",component:()=>Promise.all([o.e(0),o.e(13)]).then(o.bind(null,279))},compact:{name:"compact",tag:"the-biq-search-form-compact",component:()=>Promise.all([o.e(0),o.e(14)]).then(o.bind(null,280))}};var n={name:"TheSearchForm",components:{...(e=>{const t=Object.keys(e).map(t=>[e[t].tag,e[t].component]);return Object.fromEntries(t)})(s)},props:{biqPublicKey:{type:String,required:!0,default:""},biqPlacesLookup:{type:String,required:!0,default:"//places/?term="},biqQuotesFrom:{type:String,required:!0,default:"//booking/quote/"},layout:{type:String,default:s.compact.name,required:!0,validator:e=>Object.keys(s).indexOf(e)>-1},searchOnLoad:{type:Boolean,default:!1},debugging:{type:Boolean,default:!1},useButtons:{type:Boolean,default:!0}},computed:{useLayout:function(){switch(this.layout){case s.compact.name:return s.compact.tag;case s.column.name:return s.column.tag}}},methods:{onBiqQuotesSearched:function(e){this.$emit(r.f.biqQuotesSearched.name,e)},onBiqZeroQuotes:function(e){this.$emit(r.f.biqZeroQuotes.name,e)},onBiqQuotesError:function(e){this.$emit(r.f.biqQuotesError.name,e)}}},i=o(19),a=Object(i.a)(n,(function(){var e=this,t=e.$createElement;return(e._self._c||t)(e.useLayout,{tag:"component",attrs:{"biq-public-key":e.biqPublicKey,"biq-places-lookup":e.biqPlacesLookup,"biq-quotes-from":e.biqQuotesFrom,"search-on-load":e.searchOnLoad,debugging:e.debugging,"use-buttons":e.useButtons,"id-prefix":"biq"},on:{biqQuotesSearched:e.onBiqQuotesSearched,biqZeroQuotes:e.onBiqZeroQuotes,biqQuotesError:e.onBiqQuotesError}})}),[],!1,null,null,null);t.a=a.exports}},[[253,1,0]]]);
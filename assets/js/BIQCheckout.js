(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{255:function(e,t,s){},257:function(e,t,s){"use strict";var n=s(255);s.n(n).a},258:function(e,t,s){"use strict";s.r(t);var n=s(17),r=s(73),i=s(28),a=s.n(i),o=s(72),l={name:"PassengerDetailsForm",mixins:[o.a],props:{values:{type:Object,default:function(){return{name:"",email:"",telephone:"",flight_number:""}}}},data:()=>({heading:"Passenger Details",fields:{name:{value:"",label:"Name",required:!0,error:null,errorMsg:"Booking name must be set",id:"customer_name",placeholder:"Enter your name",help:"The name of the person travelling."},email:{value:"",label:"Email",required:!0,error:null,errorMsg:"Email location must be set",id:"customer_email",placeholder:"Enter your email",help:"We'll never share your email with anyone else."},telephone:{value:"",label:"Mobile telephone",required:!0,error:null,errorMsg:"Telephone must be set",id:"telephone",placeholder:"Enter a mobile number",help:"Valid UK mobile numbers only, please."},flight_number:{value:"",label:"Flight #",required:!1,error:null,errorMsg:"",id:"flight_number",placeholder:"Enter your flight number",help:"If this is an airport pickup or dropoff, the relevent flight number"}}})},d=s(14),c=Object(d.a)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"biq-passenger-details-form-section"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("h4",{attrs:{id:"tc_plugin-passenger-heading"}},[e._v(e._s(e.heading))])])]),e._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-passenger-name"}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:e.fields.name.id}},[e._v(e._s(e.fields.name.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.name.value,expression:"fields.name.value"}],staticClass:"form-control",class:e.errorStateClass("name"),attrs:{id:e.fields.name.id,placeholder:e.fields.name.placeholder,required:e.fields.name.required,type:"text","aria-describedby":"nameHelp"},domProps:{value:e.fields.name.value},on:{input:function(t){t.target.composing||e.$set(e.fields.name,"value",t.target.value)}}}),e._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"nameHelp"}},[e._v(e._s(e.fields.name.help))])])]),e._v(" "),s("div",{staticClass:"col"},[s("div",{staticClass:"form-group",attrs:{id:"tcplugin-email"}},[s("label",{attrs:{for:e.fields.email.id}},[e._v(e._s(e.fields.email.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.email.value,expression:"fields.email.value"}],staticClass:"form-control",class:e.errorStateClass("email"),attrs:{id:e.fields.email.id,placeholder:e.fields.email.placeholder,required:e.fields.email.required,type:"email","aria-describedby":"emailHelp"},domProps:{value:e.fields.email.value},on:{input:function(t){t.target.composing||e.$set(e.fields.email,"value",t.target.value)}}}),e._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"emailHelp"}},[e._v(e._s(e.fields.email.help))])])])]),e._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-passenger-telephone"}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:e.fields.telephone.id}},[e._v(e._s(e.fields.telephone.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.telephone.value,expression:"fields.telephone.value"}],staticClass:"form-control",class:e.errorStateClass("telephone"),attrs:{id:e.fields.telephone.id,placeholder:e.fields.telephone.placeholder,required:e.fields.telephone.required,type:"text","aria-describedby":"mobileHelp"},domProps:{value:e.fields.telephone.value},on:{input:function(t){t.target.composing||e.$set(e.fields.telephone,"value",t.target.value)}}}),e._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"mobileHelp"}},[e._v(e._s(e.fields.telephone.label))])])]),e._v(" "),s("div",{staticClass:"col"},[s("div",{staticClass:"form-group",attrs:{id:"tcplugin-flight-number"}},[s("label",{attrs:{for:e.fields.flight_number.id}},[e._v(e._s(e.fields.flight_number.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.flight_number.value,expression:"fields.flight_number.value"}],staticClass:"form-control",class:e.errorStateClass("flight_number"),attrs:{id:e.fields.flight_number.id,placeholder:e.fields.flight_number.placeholder,required:e.fields.flight_number.required,type:"text","aria-describedby":"flightHelp"},domProps:{value:e.fields.flight_number.value},on:{input:function(t){t.target.composing||e.$set(e.fields.flight_number,"value",t.target.value)}}}),e._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"flightHelp"}},[e._v(e._s(e.fields.flight_number.help))])])])])])}),[],!1,null,null,null).exports;class u{constructor(e,t,s){this.getPublicHandler=this.getPublicHandler.bind(this),this.getHandlerName=this.getHandlerName.bind(this),this.getAmount=this.getAmount.bind(this),this.getDescriptor=this.getDescriptor.bind(this),this.setAmount=this.setAmount.bind(this),this.updateAmount=this.updateAmount.bind(this),this.getTransactionToken=this.getTransactionToken.bind(this),this.handle=this.handle.bind(this),this.country="GB",this.currency="gbp",this.transactionSuccessCB=e,this.transactionFailCB=t,this.debugging=s,this.amount=0,this.descriptor="",this.paymentHandlerName="unknown"}getPublicHandler(){return{getHandlerName:this.getHandlerName,getAmount:this.getAmount,getDescriptor:this.getDescriptor,updateAmount:this.updateAmount,getTransactionToken:this.getTransactionToken}}getHandlerName(){return this.paymentHandlerName}getAmount(){return this.amount}getDescriptor(){return this.descriptor}setAmount(e,t){this.amount=100*e,this.descriptor=t}updateAmount(e){this.amount=100*e}getTransactionToken(e,t,s,n){this.handle(this.getPublicHandler,this.transactionSuccessCB,this.transactionFailCB,{...n,key:e,quote:t,vehicle:s})}handle(e,t,s,n){s(e(),"No payment handler to handle the transaction")}}class p extends u{constructor(e,t,s){super(e,t,s),this.getPublicHandler=this.getPublicHandler.bind(this),this.handle=this.handle.bind(this),this.initialise=this.initialise.bind(this),this.mountElement=this.mountElement.bind(this),this.unmountElement=this.unmountElement.bind(this),this.getCustomerToken=this.getCustomerToken.bind(this),this.setCustomerToken=this.setCustomerToken.bind(this),this.getClientSecretIntent=this.getClientSecretIntent.bind(this),this.paymentHandlerName="jstoken_stripe",this.customer_token=null,this.elementMounted=!1,this.elementMountedOn="stripe-card-form"}initialise(e,t,s,n,r){this.debugging&&(console.group("Stripe card form handler initialising..."),console.info(e),console.info(t),console.info(s),console.info(n),console.info(r)),this.pk=e,this.intent_secret_uri=t,this.elementMountedOn=s,this.stripe=Stripe(this.pk),this.stripeElements=this.stripe.elements();const i={style:n,hidePostalCode:void 0!==r&&!!r};this.debugging&&console.info(i),this.card=this.stripeElements.create("card",i),this.debugging&&(console.log("Stripe card form handler initialised"),console.groupEnd())}getPublicHandler(){return{...super.getPublicHandler(),mountElement:this.mountElement,unmountElement:this.unmountElement,getCustomerToken:this.getCustomerToken,setCustomerToken:this.setCustomerToken}}mountElement(){this.elementMounted||(this.debugging&&console.log("Mounting Stripe card element on "+this.elementMountedOn),this.card.mount(document.getElementById(this.elementMountedOn)),this.elementMounted=!0)}unmountElement(){this.elementMounted&&(this.debugging&&console.log("Unmounting Stripe card element from "+this.elementMountedOn),this.card.unmount(document.getElementById(this.elementMountedOn)),this.elementMounted=!1)}getCustomerToken(){return this.customer_token}setCustomerToken(e){this.customer_token=e}handle(e,t,s,n){const{key:r,quote:i,vehicle:a,cardholder_name:o,billing_postcode:l}=n,d=this.stripe,c=this.card;this.getClientSecretIntent(r,i,a).then(n=>{d.confirmCardPayment(n,{payment_method:{card:c,billing_details:{name:o,address:{postal_code:l}}}},{handleActions:!1}).then(r=>{if(r.error)s(e(),r.error);else{if(r.paymentIntent.hasOwnProperty("status")&&"succeeded"===r.paymentIntent.status)return void t(e(),r.paymentIntent);d.confirmCardPayment(n).then(n=>{n.error?s(e(),n.error):t(e(),n.paymentIntent)})}}).catch(t=>{s(e(),t)})})}getClientSecretIntent(e,t,s){const n=this.getPublicHandler(),r=this.intent_secret_uri,i=this.debugging;return this.debugging&&console.group("Getting client secret from "+r),new Promise((o,l)=>{const d=new FormData;d.append("handler",n.getHandlerName()),d.append("key",e),d.append("quote",t),d.append("vehicle",s),a()({url:r,method:"post",data:d,responseType:"json",headers:{"Content-Type":"application/application/x-www-form-urlencoded"}}).then(e=>{i&&(console.log(e),console.groupEnd()),o(e.data.response.intent.client_secret)}).catch(e=>{let t=e;t=e.response?e.response:e.request?e.request:e.message,console.error(e),i&&(console.warn(`The error message received was: '${t}'`),console.info(d),console.groupEnd()),l(t)})})}}var m=s(74);const h={name:"submit"},g={name:"transactionSuccess"},f={name:"transactionError"};var b={name:"StripeCardFormElement",components:{"biq-process-form-submit":m.a},props:{apiClientSecretFrom:{type:String,required:!0,default:"//booking/client_gateway_secret/"},stripePublicKey:{type:String,required:!0,default:""},stripeCardFormStyle:{type:Object,required:!0,default:function(){return{base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}}}},hidePostalCode:{type:Boolean,default:!1},processing:{type:Boolean,default:!1},amount:{type:Number,required:!0,default:0},descriptor:{type:String,default:""},id:{type:String,default:"biq-stripe-card-details"},label:{type:String,default:"Card Details"},validClass:{type:String,default:""},errorClass:{type:String,default:"is-invalid"},debugging:{type:Boolean,default:!1},useButtons:{type:Boolean,default:!0}},data(){return{mount_on:"stripe-card-form",validation_run:!1,has_errors:!1,paymentHandler:new p(this.onHandlerSuccess,this.onHandlerError,this.debugging)}},computed:{errorStateClass:function(){return this.validation_run?this.has_errors?this.errorClass:this.validClass:""}},created(){this.paymentHandler.initialise(this.stripePublicKey,this.apiClientSecretFrom,this.mount_on,this.stripeCardFormStyle,this.hidePostalCode)},mounted(){this.paymentHandler.setAmount(this.amount,this.descriptor),this.paymentHandler.mountElement()},methods:{onSubmit:function(e){this.processing||(e.data={paymentHandler:this.paymentHandler.getPublicHandler()},this.$emit(h.name,e))},onHandlerSuccess:function(e,t){const s={data:{paymentHandler:e,paymentIntent:t}};this.$emit(g.name,s)},onHandlerError:function(e,t){t.hasOwnProperty("message")&&t.message||(t.message="Unknown Stripe Error");const s={data:{paymentHandler:e,error:t}};this.$emit(f.name,s)},validate:function(){this.validation_run=!0;const e=this.$refs.card.classList;return this.has_errors=e.contains("StripeElement--invalid")||e.contains("StripeElement--empty"),!this.has_errors}}},_=Object(d.a)(b,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col",attrs:{id:e.id}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:e.mount_on}},[e._v(e._s(e.label))]),e._v(" "),s("div",{ref:"card",staticClass:"form-control stripe-card-container",class:e.errorStateClass,attrs:{id:e.mount_on}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("biq-process-form-submit",{attrs:{processing:e.processing,"use-buttons":e.useButtons,label:"Book Now"},on:{click:e.onSubmit}})],1)])}),[],!1,null,null,null).exports,v={name:"StripeCardPayment",mixins:[o.a],components:{"stripe-card-form-element":_},props:{appConfig:{type:Object,required:!0,default:function(){return null}},appSettings:{type:Object,required:!0,default:function(){return null}},stripeCardFormStyle:{type:Object,required:!0,default:function(){return{base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}}}},values:{type:Object,default:function(){return{cardholder_name:"",billing_postcode:""}}},processing:{type:Boolean,default:!1},amount:{type:Number,required:!0,default:0},descriptor:{type:String,default:""},id:{type:String,default:"biq-stripe-card-details"},name:{type:String,default:"stripe"},label:{type:String,default:"Card Details"}},data:()=>({fields:{cardholder_name:{value:"",label:"Cardholder Name",required:!0,error:!1,errorMsg:"Cardholder name must be set",id:"card-holder-name",placeholder:"Cardholder Name"},billing_postcode:{value:"",label:"Billing Postcode",required:!0,error:!1,errorMsg:"Billing address postcode must be set",id:"billing-postcode",placeholder:"Billing Postcode"}},card_error:!1,card_error_message:""}),methods:{onSubmit:function(e){this.processing||(this.card_error=!1,this.card_error_message="",e.data={source:this.name,...e.data},this.$emit(h.name,e))},onTransactionSuccess:function(e){const{cardholder_name:t,billing_postcode:s}=this.fields;e.data={source:this.name,...e.data,formdataAppend:n=>(this.debugging&&console.log(e.data.paymentIntent),n.append("card_cardholder",t.value),n.append("postcode",s.value),n)},this.$emit(g.name,e)},onTransactionError:function(e){this.card_error=!0,this.card_error_message=e.data.error.message,e.data={source:this.name,type:"transaction",...e.data},this.$emit(f.name,e)},specialValidationErrors:function(){const e={};return this.$refs.card.has_errors&&(e.card=this.card_error?this.card_error_message:"Please provide valid card details"),{...e}},validate:function(){let e=0;return this.$refs.card.validate()||e++,this.validateValues()||e++,0==e}}},y=(s(257),Object(d.a)(v,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:"tcplugin-cardholder-details"}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:e.fields.cardholder_name.id}},[e._v(e._s(e.fields.cardholder_name.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.cardholder_name.value,expression:"fields.cardholder_name.value"}],staticClass:"form-control",class:e.errorStateClass("cardholder_name"),attrs:{id:e.fields.cardholder_name.id,placeholder:e.fields.cardholder_name.placeholder,required:e.fields.cardholder_name.required,type:"text"},domProps:{value:e.fields.cardholder_name.value},on:{input:function(t){t.target.composing||e.$set(e.fields.cardholder_name,"value",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:e.fields.billing_postcode.id}},[e._v(e._s(e.fields.billing_postcode.label))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.fields.billing_postcode.value,expression:"fields.billing_postcode.value"}],staticClass:"form-control",class:e.errorStateClass("billing_postcode"),attrs:{id:e.fields.billing_postcode.id,placeholder:e.fields.billing_postcode.placeholder,required:e.fields.billing_postcode.required,type:"text"},domProps:{value:e.fields.billing_postcode.value},on:{input:function(t){t.target.composing||e.$set(e.fields.billing_postcode,"value",t.target.value)}}})])]),e._v(" "),s("stripe-card-form-element",{ref:"card",attrs:{"api-client-secret-from":""+e.appSettings.biq_api_host+e.appConfig.CLIENT_SECRET_URI,"stripe-public-key":e.appSettings.stripe_pk,amount:e.amount,"stripe-card-form-style":e.stripeCardFormStyle,"hide-postal-code":e.appConfig.PGH_CONF.hidePostalCode,processing:e.processing,id:e.id,label:e.label,descriptor:e.descriptor,debugging:e.debugging,"use-buttons":e.appConfig.useButtons},on:{submit:e.onSubmit,transactionSuccess:e.onTransactionSuccess,transactionError:e.onTransactionError}})],1)}),[],!1,null,"79c09b85",null).exports);class C extends u{constructor(e,t,s){super(e,t,s),this.handle=this.handle.bind(this),this.paymentHandlerName="paypal"}handle(e,t,s,n){const{key:r,quote:i,vehicle:a,nonce:o}=n;this.debugging&&(console.group("Paypal payment transaction handler"),console.log(n),console.log(r),console.log(i),console.log(a),console.log(o),console.groupEnd());const l={id:o};t(e(),l)}}var k={name:"PaypalPayment",components:{"biq-process-form-submit":m.a},props:{authorization:{type:String,required:!0,default:""},processing:{type:Boolean,default:!1},amount:{type:Number,required:!0,default:0},descriptor:{type:String,default:""},id:{type:String,default:"biq-paypal-plugin"},name:{type:String,default:"paypal"},label:{type:String,default:"Pay With Paypal"},debugging:{type:Boolean,default:!1},useButtons:{type:Boolean,default:!0}},data(){return{setup:{flow:"checkout",amount:this.amount,currency:"GBP"},paymentHandler:new C(this.onHandlerSuccess,this.onHandlerError,this.debugging),error:!1,error_message:""}},mounted(){this.paymentHandler.setAmount(this.amount,this.descriptor)},methods:{onHandlerSuccess:function(e,t){const s={data:{source:this.name,type:"transaction",paymentHandler:e,paymentIntent:t,formdataAppend:e=>e}};this.$emit(g.name,s)},onHandlerError:function(e,t){t.hasOwnProperty("message")&&t.message||(t.message="Unknown Paypal Error");const s={data:{source:this.name,type:"transaction",paymentHandler:e,error:t}};this.$emit(f.name,s)},onTransactionSuccess:function(e){this.debugging&&(console.group("Paypal transaction succeeded event"),console.log(e),console.groupEnd()),this.processing||(this.card_error=!1,this.card_error_message="",e.data={source:this.name,paymentHandler:this.paymentHandler.getPublicHandler()},this.$emit(h.name,e))},onTransactionError:function(e){this.debugging&&(console.group("Paypal transaction error event"),console.log(e),console.groupEnd()),this.onHandlerError(this.paymentHandler.getPublicHandler(),e)},onLoadFail:function(e){this.debugging&&(console.group("Paypal loading error event"),console.log(e),console.groupEnd()),e.hasOwnProperty("message")&&e.message||(e.message="Unknown Paypal Loading Error");const t={data:{source:this.name,type:"loading",paymentHandler:this.paymentHandler.getPublicHandler(),error:e}};this.$emit(f.name,t)}}},S=Object(d.a)(k,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row"},[s("div",{staticClass:"col"}),e._v(" "),s("div",{staticClass:"col",attrs:{id:e.id}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"paypal"}},[e._v(e._s(e.label))]),e._v(" "),s("v-braintree",{attrs:{authorization:e.authorization,paypal:e.setup},on:{success:e.onTransactionSuccess,error:e.onTransactionError,loadFail:e.onLoadFail},scopedSlots:e._u([{key:"button",fn:function(t){return[s("div",{staticClass:"form-group"},[s("biq-process-form-submit",{attrs:{processing:e.processing,"use-buttons":e.useButtons,label:"Book Now"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}})],1)]}}])})],1)])])}),[],!1,null,null,null).exports;const E={name:"biqCheckoutSubmit"},P={name:"biqCheckoutComplete"},q={name:"biqCheckoutError"};var w={name:"TheCheckoutForm",mixins:[o.a],components:{"biq-passenger-details-form-section":c,"stripe-card-payment":y,"paypal-payment":S},props:{appConfig:{type:Object,required:!0,default:function(){return null}},appSettings:{type:Object,required:!0,default:function(){return null}},stripeCardFormStyle:{type:Object,required:!0,default:function(){return{base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}}}},paypalClientToken:{type:String,required:!0,default:""},processing:{type:Boolean,default:!1}},data:()=>({payment_heading:"Payment Details",transaction_descriptor:"Taxi Journey",has_errors:!1,error_message:"",validation_errors:{},fields:{method:{selected:"Pay with Card",options:["Pay with Card","Pay with Paypal"],label:"Select Payment Method:",errorMsg:"Cardholder name must be set",id:"tcplugin-payament-select"}}}),computed:{...Object(n.c)(["journeyID","processed","basket","quoteID","vehicleIndex","price"]),isCardPayment:function(){return"Pay with Card"===this.fields.method.selected},isPaypalPayment:function(){return"Pay with Paypal"===this.fields.method.selected},formSections:function(){const e=["passengerForm"];switch(this.fields.method.selected){case"Pay with Card":e.push("cardForm")}return e}},methods:{...Object(n.b)(["quoting","quoted","bookNow","booking","booked","bookingFailed"]),onSubmit:function(e){if(this.processing)return;if(this.booking(),!this.validate())return this.debugging&&(console.group(`BIQ CheckoutForm '${e.data.source}' Validation Error`),console.log(e),console.log(this.validation_errors),console.groupEnd()),this.bookingFailed(),!1;this.debugging&&(console.group(`BIQ CheckoutForm '${e.data.source}' Submit Event`),console.log(e),console.groupEnd()),this.error_message="",this.validation_errors={},this.has_errors=!1;let t=null;switch(e.data.source){case"paypal":return t={...e},e.data.paymentHandler.getTransactionToken(this.appSettings.biq_pk,this.quoteID,this.vehicleIndex,t);case"stripe":return t={...this.$refs.cardForm.inputValues()},e.data.paymentHandler.getTransactionToken(this.appSettings.biq_pk,this.quoteID,this.vehicleIndex,t);default:return this.$emit(E.name,e)}},onTransactionSuccess:function(e){const{paymentHandler:t,paymentIntent:s,formdataAppend:n}=e.data;this.makeBooking(s.id,t.getHandlerName(),n)},onTransactionError:function(e){this.error_message=e.data.error.message,this.has_errors=!0,e.data.booking=null,this.bookingFailed(),this.$emit(q.name,e)},validate:function(){let e=0,t={};return this.formSections.forEach(s=>{this.$refs[s].validate()||(t={...t,...this.$refs[s].validationErrors()},e++)}),this.validation_errors=t,0==e},makeBooking:function(e,t,s){const n=this,r=this.assembleData(e,t,s),i=`${this.appSettings.biq_api_host}${this.appConfig.PAYMENT_URI}`;this.debugging&&console.info(`BIQ Checkout transaction attempt to API '${i}'`),a.a.post(i,r,{headers:{"Content-Type":"application/application/x-www-form-urlencoded"}}).then(e=>{if("OK"!=e.data.status)throw new ErrorEvent(e.data.status,{error:new Error("BIQ API Checkout Error"),message:e.data[e.data.status.toLowerCase()]});n.checkoutComplete(e.data)}).catch(s=>{n.has_errors=!0,n.error_message=s.message||"Unknown BIQ API Checkout Error",this.bookingFailed();const a={data:{type:"booking",booking:{URL:i,refunded:!1,token:e,method:t,formData:r},error:s}};n.$emit(q.name,a)})},assembleData:function(e,t,s){const n=new FormData,r=this.$refs.passengerForm.inputValues();return console.log(r),n.append("key",this.appSettings.biq_pk),n.append("quote",this.quoteID),n.append("vehicle",this.vehicleIndex),n.append("new_pay",!0),n.append("email",r.email),n.append("name",r.name),n.append("telephone",r.telephone),n.append("payment_token",e),n.append("method",t),"function"==typeof s&&s(n),r.flight_number&&n.append("flight_number",r.flight_number),this.appSettings.booking_test_mode&&n.append("test","1"),n},checkoutComplete:function(e){const t=this.booked,s={updateCheckoutState:()=>t({booking_ref:e.reference}),data:{booking_ref:e.reference,status:e.status}};this.$emit(P.name,s)}}},H=Object(d.a)(w,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("form",{attrs:{id:"purchaseform"}},[s("biq-passenger-details-form-section",{ref:"passengerForm",attrs:{debugging:e.debugging}}),e._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("h4",{attrs:{id:"tc_plugin-payment-heading"}},[e._v(e._s(e.payment_heading))])])]),e._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col",attrs:{id:e.fields.method.id}},[e._v(e._s(e.fields.method.label))]),e._v(" "),s("div",{staticClass:"col"},[s("b-form-select",{attrs:{options:e.fields.method.options,disabled:e.processing},model:{value:e.fields.method.selected,callback:function(t){e.$set(e.fields.method,"selected",t)},expression:"fields.method.selected"}})],1)]),e._v(" "),e.isCardPayment?s("stripe-card-payment",{ref:"cardForm",attrs:{"app-config":e.appConfig,"app-settings":e.appSettings,processing:e.processing,amount:e.price,descriptor:e.transaction_descriptor,"stripe-card-form-style":e.stripeCardFormStyle,debugging:e.debugging,id:"tcplugin-stripe-card-details",label:"Card Details"},on:{submit:e.onSubmit,transactionSuccess:e.onTransactionSuccess,transactionError:e.onTransactionError}}):e.isPaypalPayment?s("paypal-payment",{ref:"paypalForm",attrs:{authorization:e.paypalClientToken,processing:e.processing,amount:e.price,descriptor:e.transaction_descriptor,debugging:e.debugging,useButtons:e.appConfig.useButtons,id:"tcplugin-paypal-plugin",label:"Or Pay With Paypal"},on:{submit:e.onSubmit,transactionSuccess:e.onTransactionSuccess,transactionError:e.onTransactionError}}):s("div",{staticClass:"row"},[s("div",{staticClass:"col"}),e._v(" "),s("div",{staticClass:"col"})])],1),e._v(" "),e.has_errors?s("div",{staticClass:"row"},[e._t("checkout-error",[s("div",{staticClass:"col",attrs:{id:"tcplugin-payment-error"}},[e._v(e._s(e.error_message))])],{error:{message:e.error_message}})],2):e._e()])}),[],!1,null,null,null).exports,T={name:"QuotedJourneyDetails",props:{price:{type:Number,default:0}},computed:Object(n.c)(["journeyDetails","journeyDate","journeyTime","journeyHasReturn","journeyReturnDate","journeyReturnTime","journeyHasVias"])},x=Object(d.a)(T,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col",attrs:{id:"tcplugin-checkout-booking-details"}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[e._v("\n            Booking Details\n        ")]),e._v(" "),s("ul",{staticClass:"list-group list-group-flush"},[s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Date:")]),e._v(" "+e._s(e.journeyDate)+" at "+e._s(e.journeyTime)+"\n            ")]),e._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Travelling From:")]),e._v(" "+e._s(e.journeyDetails.pickup.string)+"\n            ")]),e._v(" "),s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Going To:")]),e._v(" "+e._s(e.journeyDetails.destination.string)+"\n            ")]),e._v(" "),e.journeyHasVias?s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Via:")]),e._v(" "+e._s(e.journeyDetails.vias[0].string)+"\n            ")]):e._e(),e._v(" "),e.journeyHasReturn?s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Returning:")]),e._v(" "+e._s(e.journeyReturnDate)+" at "+e._s(e.journeyReturnTime)+"\n            ")]):e._e(),e._v(" "),e.price>0?s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("strong",[e._v("Price:")]),e._v(" £"+e._s(e.price.toFixed(2))+"\n            ")]):e._e()])])])}),[],!1,null,null,null).exports,j={name:"CheckoutPage",mixins:[r.a],components:{"the-biq-checkout-form":H,"biq-quoted-journey-details":x},props:{stripe_cardform_style:{type:Object,required:!0,default:function(){return{base:{fontFamily:"'Muli', sans-serif",fontSize:"14px",color:"#333"},invalid:{color:"red"}}}},paypalClientToken:{type:String,required:!0,default:""}},computed:{...Object(n.c)(["processing","price"])},methods:{onSubmit:function(e){this.debugging&&(console.group("BIQ Checkout Form Submit"),console.log(e),console.groupEnd())},onCheckoutSuccess:function(e){this.debugging&&(console.group("BIQ Checkout Success"),console.log(e),console.groupEnd());const t={name:"CompletePage",params:{booking_ref:e.data.booking_ref}};this.$router.replace(t,e.updateCheckoutState,e.updateCheckoutState)},onCheckoutError:function(e){this.debugging&&(console.group("BIQ Checkout Error"),console.log(e),console.groupEnd())}}},$=Object(d.a)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("the-biq-checkout-form",{ref:"checkout",attrs:{"app-config":e.appConfig,"app-settings":e.appSettings,"stripe-card-form-style":e.stripe_cardform_style,"paypal-client-token":e.paypalClientToken,processing:e.processing,debugging:e.debugging},on:{biqCheckoutSubmit:e.onSubmit,biqCheckoutComplete:e.onCheckoutSuccess,biqCheckoutError:e.onCheckoutError},scopedSlots:e._u([{key:"checkout-error",fn:function(t){var n=t.error;return[s("div",{staticClass:"col",attrs:{id:"tcplugin-payment-error"}},[e._v(e._s(n.message))])]}}])}),e._v(" "),s("div",{staticClass:"row"},[s("biq-quoted-journey-details",{attrs:{price:e.price}})],1)],1)}),[],!1,null,null,null);t.default=$.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{433:function(o,e,t){"use strict";t.r(e);var n=t(17),r=t.n(n),s=t(408),a=t.n(s),i=t(409),c=t(21);const p=(o,e)=>[(o[0]+e[0])/2,(o[1]+e[1])/2],l={mapboxPublicKey:{type:String,required:!0,default:""},mapboxStyle:{type:String,required:!0,default:"mapbox://styles/mapbox/navigation-night-v1"},pickup:{type:Array,required:!0,default:function(){return c.b.london}},destination:{type:Array,required:!0,default:function(){return c.b.lhr}},debugging:{type:Boolean,default:!1}},u={name:"directionsError"};var d={name:"JourneyRouteMap",props:l,computed:{coordsPickup:function(){return c.b.toCoords(this.pickup)},coordsDestination:function(){return c.b.toCoords(this.destination)},coordsCenter:function(){return c.b.toCoords(p(this.pickup,this.destination))},geoJSONLayerSource:function(){const o=this.geo_json.coords;return{type:"geojson",data:{id:this.geo_json.conf.layer_source_id,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}}}}},methods:{async snapTo(o){console.log("actions",o);const{fitBounds:e,setCenter:t,zoomOut:n}=o,r=c.b.toCoords(this.pickup),s=c.b.toCoords(this.destination);await e([r,s],{animate:!0}),this.markers={a:[r.lng,r.lat],b:[s.lng,s.lat]},await n()},async onMapLoaded(o){const e=this;console.log("load event",o);const t={pickup:this.pickup,dest:this.destination,center:this.center,ha:c.b.toCoords(p(this.pickup,this.destination)),eh:p(this.pickup,this.destination),coordsPickup:this.coordsPickup,coordsDest:this.coordsDestination,coordsCenter:this.coordsCenter,geo:c.b,markers:this.markers};console.log("WTF",t),this.map=o.map;try{const t=(n=this.pickup,s=this.destination,a=this.mapboxPublicKey,`https://api.mapbox.com/directions/v5/mapbox/driving/${n.join(",")+";"+s.join(",")}?geometries=geojson&access_token=${a}`);this.debugging&&console.log("Mapbox API URL",t);const i=async t=>{e.debugging&&console.log("Mapbox API Response",t),e.geo_json.coords=t.data.routes[0].geometry.coordinates,await this.snapTo(o.component.actions)};r.a.get(t).then(i)}catch(o){e.debugging&&(console.log("Mapbox API Error",{...o}),console.error(o)),e.$emit(u.name,o)}var n,s,a}},components:{"route-map":i.b,"map-marker":i.c,"map-geo-json-layer":i.a},data(){return{map_conf:{repaint:!1,controls:!1},map:null,style:this.mapboxStyle,center:c.b.toCoords(p(this.pickup,this.destination)),markers:{a:!1,b:!1},geo_json:{conf:{active:!0,replace:!0,replace_source:!0,layer_source_id:"thisIsMySource",layer_id:"myLayer"},coords:[this.pickup,this.destination],layer:{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#0876BA","line-width":4,"line-opacity":1}}}}},created(){this.mapbox=a.a}},m=t(18),g=Object(m.a)(d,(function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("route-map",{ref:"mpbx",attrs:{repaint:o.map_conf.repaint,"attribution-control":o.map_conf.controls,"access-token":o.mapboxPublicKey,"map-style":o.style,center:o.center},on:{load:o.onMapLoaded}},[o.markers.a?t("map-marker",{attrs:{coordinates:o.markers.a,color:"blue"}}):o._e(),o._v(" "),o.markers.b?t("map-marker",{attrs:{coordinates:o.markers.b,color:"blue"}}):o._e(),o._v(" "),o.geo_json.conf.active?t("map-geo-json-layer",{attrs:{"layer-id":o.geo_json.conf.layer_id,"source-id":o.geo_json.conf.layer_source_id,layer:o.geo_json.layer,source:o.geoJSONLayerSource,replace:o.geo_json.conf.replace,replaceSource:o.geo_json.conf.replace_source}}):o._e()],1)}),[],!1,null,null,null);e.default=g.exports}}]);